(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"0c29":function(t,e,a){},d312:function(t,e,a){"use strict";a("0c29")},da88:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("po")],1)},n=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("header_vel",[t._v("\n        Ordenes de compra\n    ")]),a("tabs",{attrs:{sizeBtn:"md",FirstTabName:"Ordenes de Compra",SecondTabName:"Historial"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}}),2===t.active?a("div",[a("div",{staticClass:"q-mt-md",staticStyle:{display:"flex"}},[t.hiddenNotifi?a("notificationsCounterForIten",{attrs:{url:"po",num:0,cargarNotifi:0}}):t._e(),a("q-btn",{ref:"po.create",attrs:{label:"crear",icon:"add"},on:{click:function(e){t.showModal=!t.showModal}}}),a("filter-po")],1),t.order.length>0?a("q-list",{attrs:{dark:"",bordered:"",separator:""}},t._l(t.order,(function(e,i){return 1!=e.status_finanza&&2!=e.status_finanza&&5!=e.status_finanza||1!=e.status_po&&2!=e.status_po&&5!=e.status_po?t._e():a("orderCard",{key:i,attrs:{order:e}})})),1):t._e()],1):t._e(),1===t.active?a("div",[t.order.length>0?a("q-list",{attrs:{dark:"",bordered:"",separator:""}},t._l(t.order,(function(e,i){return 2!=e.status_finanza&&5!=e.status_finanza||3!=e.status_po?t._e():a("orderCard",{key:i,attrs:{order:e}})})),1):t._e()],1):t._e(),a("q-dialog",{staticClass:"flex flex-center",attrs:{persistent:"",maximized:t.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("q-card",[a("q-bar",{staticClass:"bg-primary text-white"},[a("q-space"),a("q-btn",{attrs:{dense:"",flat:"",icon:"minimize",disable:!t.maximizedToggle},on:{click:function(e){t.maximizedToggle=!1}}},[t.maximizedToggle?a("q-tooltip",{staticClass:"bg-white text-primary"},[t._v("Minimize")]):t._e()],1),a("q-btn",{attrs:{dense:"",flat:"",icon:"crop_square",disable:t.maximizedToggle},on:{click:function(e){t.maximizedToggle=!0}}},[t.maximizedToggle?t._e():a("q-tooltip",{staticClass:"bg-white text-primary"},[t._v("Maximize")])],1),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{staticClass:"bg-white text-primary"},[t._v("Close")])],1)],1),a("orderForm")],1)],1)],1)},o=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"flex flex-center"},[a("div",{staticClass:"text-h6 text-black"},[t._v("ORDEN DE COMPRA")])]),a("q-card-section",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[a("div",[a("q-select",{attrs:{outlined:"","options-dark":"","label-color":"black",options:t.suppliers,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"name"in t?t.name:"- Null -"},label:"Provedores","map-options":""},model:{value:t.supplier,callback:function(e){t.supplier=e},expression:"supplier"}})],1),a("div",[a("q-input",{attrs:{type:"textarea",label:"observaciones","label-color":"black"},model:{value:t.observations,callback:function(e){t.observations=e},expression:"observations"}})],1),a("div",{staticClass:"q-gutter-sm"},[a("q-radio",{attrs:{val:1,label:"Contado"},model:{value:t.payment_method,callback:function(e){t.payment_method=e},expression:"payment_method"}}),a("q-radio",{attrs:{val:2,label:"Credito"},model:{value:t.payment_method,callback:function(e){t.payment_method=e},expression:"payment_method"}})],1)])],1),t.materials.length?a("q-card-section",{staticClass:"q-pa-none"},[a("table",{staticClass:"full-width"},[a("thead",[a("th",[t._v("Item")]),a("th",[t._v("descripciÃ²n")]),a("th",[t._v("Cantidad")]),a("th",[t._v("Precio")]),a("th",[t._v("Modificar")])]),a("tbody",t._l(t.materials,(function(e,i){return e.select&&e.quantity>0?a("tr",{key:i},[a("td",[t._v(t._s(e.material.name))]),a("td",[t._v(t._s(e.description))]),a("td",[t._v(t._s(e.quantity))]),a("td",[t._v(t._s(e.price))]),a("td",[a("modify",{attrs:{applicants:e.applicants},on:{new_val:t.setPending}})],1)]):t._e()})),0)])]):t._e(),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"guardar",color:"primary"},on:{click:function(e){return t.save()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1)],1)},l=[],c=(a("159b"),a("c740"),a("13d5"),a("b0c0"),a("99af"),a("07ac"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-btn",{attrs:{icon:"edit"},on:{click:function(e){t.showModal=!t.showModal}}}),a("q-dialog",{model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("q-card",[a("q-form",{staticClass:"q-gutter-md",on:{submit:t.save}},[t._l(t.applicants,(function(e,i){return a("q-card-section",{key:i},[a("div",[t._v("\n           "+t._s(e.acp.demand.control_number)+"\n           ")]),a("div",[t._v("\n           "+t._s(e.acp.demand.description)+"\n           ")]),a("div",[a("q-checkbox",{attrs:{label:"seleccionado"},model:{value:t.new_quantity[e.id].select,callback:function(a){t.$set(t.new_quantity[e.id],"select",a)},expression:"new_quantity[item.id].select"}}),a("q-input",{attrs:{label:"cantidad solicitadas",rules:[function(a){return a<=t.new_quantity[e.id].pending_quantity_rule||"El numero no puede ser mayor al actual"}],type:"number"},model:{value:t.new_quantity[e.id].pending_quantity,callback:function(a){t.$set(t.new_quantity[e.id],"pending_quantity",a)},expression:"new_quantity[item.id].pending_quantity"}})],1),a("q-separator")],1)})),a("q-btn",{attrs:{label:"enviar",type:"submit"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"cerrar"}})],2)],1)],1)],1)}),d=[],u=a("9523"),p=a.n(u),m=a("ded3"),f=a.n(m),_={data:function(){return{showModal:!1,new_quantity:[]}},props:["applicants"],methods:{set:function(){this.new_quantity=this.applicants.reduce((function(t,e){return f()(f()({},t),{},p()({},e.id,{pending_quantity:e.quantity,pending_quantity_rule:e.quantity,id:e.id,demand_id:e.demand_id,material_id:e.material_id,select:e.select}))}),{})},save:function(){var t=Object.values(this.new_quantity);this.$emit("new_val",t)}},mounted:function(){this.set()}},h=_,v=a("2877"),b=a("9c40"),q=a("24e8"),y=a("f09f"),g=a("0378"),w=a("a370"),x=a("8f8e"),C=a("27f9"),k=a("eb85"),Q=a("7f67"),$=a("eebe"),z=a.n($),M=Object(v["a"])(h,c,d,!1,null,null,null),O=M.exports;z()(M,"components",{QBtn:b["a"],QDialog:q["a"],QCard:y["a"],QForm:g["a"],QCardSection:w["a"],QCheckbox:x["a"],QInput:C["a"],QSeparator:k["a"]}),z()(M,"directives",{ClosePopup:Q["a"]});var S={data:function(){return{observations:null,payment_method:null,supplier_id:null,supplier:null,suppliers:[],materials:[]}},components:{modify:O},watch:{supplier:function(){this.setSupplier()}},methods:{getSuppliers:function(){var t=this;axios.get("supplier/for_order").then((function(e){t.suppliers=e.data}))},setPending:function(t){var e=this;t.forEach((function(t){var a=e.supplier.applicants.findIndex((function(e){return e.id===t.id}));console.log(a),e.supplier.applicants[a].quantity=parseInt(t.pending_quantity),e.supplier.applicants[a].select=t.select})),this.setSupplier()},setSupplier:function(){this.supplier_id=this.supplier.id;var t=this.supplier.applicants,e=function(t){return function(e){return e.reduce((function(e,a){var i=a[t].name;return e[i]=(e[i]?e[i]:[]).concat(a),e}),{})}},a=e("material"),i=Object.values(a(t)),n=[];i.forEach((function(t){t.forEach((function(t){var e=[];e.push(t.acp_id);var a=[];t.hasOwnProperty("select")||Object.defineProperty(t,"select",{enumerable:!0,configurable:!0,writable:!0,value:!0}),a.push(t);var i=n.findIndex((function(e){return e.material.inventory_id===t.material.inventory_id}));if(-1!=i)n[i].quantity=t.select?t.quantity+n[i].quantity:n[i].quantity,n[i].acp_id.push(t.acp_id),n[i].applicants.push(t);else{var r={material:t.material,quantity:t.select?t.quantity:0,price:t.price,acp_id:e,material_id:t.material_id,applicants:a,select:t.select};n.push(r)}}))})),this.materials=n},save:function(){var t=this,e={supplier_id:this.supplier_id,observations:this.observations,payment_method:this.payment_method,acps:this.supplier.applicants};this.$q.loading.show(),axios.post("order/store",e).then((function(e){console.log(e),t.$q.notify({message:"Orden de Compra Generada Exitosamente",color:"green"}),t.$q.loading.hide(),t.$root.$emit("order_refresh")})).catch((function(t){console.log(t)}))}},mounted:function(){this.getSuppliers()}},P=S,T=(a("d312"),a("ddd8")),E=a("3786"),N=a("4b7e"),j=Object(v["a"])(P,s,l,!1,null,null,null),F=j.exports;z()(j,"components",{QCard:y["a"],QCardSection:w["a"],QForm:g["a"],QSelect:T["a"],QInput:C["a"],QRadio:E["a"],QCardActions:N["a"],QBtn:b["a"]}),z()(j,"directives",{ClosePopup:Q["a"]});var I=a("4d84"),B=a("62e8"),D=a("4819"),R=a("d784d"),A=a("e93a"),H={data:function(){return{showModal:!1,maximizedToggle:!0,active:2,hiddenNotifi:!0}},components:{orderForm:F,orderCard:I["a"],header_vel:R["a"],filterPo:B["a"],notificationsCounterForIten:A["a"],tabs:D["a"]},computed:{order:{get:function(){return this.$store.getters["order/orders"]}}},methods:{filtrar:function(){this.$store.commit("order/SetFilterType",1),this.$store.commit("order/filter")}},mounted:function(){var t=this;this.$store.dispatch("order/getorder").then((function(){t.filtrar()})).catch((function(e){t.$q.notify({message:"Ha ocurrido un error",color:"red",position:"right"})})),this.$root.$on("order_refresh",(function(){t.$store.dispatch("order/getorder").then((function(){t.filtrar()})),t.showModal=!1})),this.$route.params.id&&this.$refs["po.create"].click()}},J=H,G=a("1c1c"),L=a("d847"),K=a("2c91"),U=a("05c0"),V=Object(v["a"])(J,r,o,!1,null,null,null),W=V.exports;z()(V,"components",{QBtn:b["a"],QList:G["a"],QDialog:q["a"],QCard:y["a"],QBar:L["a"],QSpace:K["a"],QTooltip:U["a"]}),z()(V,"directives",{ClosePopup:Q["a"]});var X={components:{po:W}},Y=X,Z=a("9989"),tt=Object(v["a"])(Y,i,n,!1,null,null,null);e["default"]=tt.exports;z()(tt,"components",{QPage:Z["a"]})}}]);