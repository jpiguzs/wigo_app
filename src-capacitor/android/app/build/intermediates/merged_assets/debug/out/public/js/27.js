(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{b45a:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("inventario")],1)},o=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("header_vel",[t._v("\n    Inventario\n")]),a("tabs",{attrs:{sizeBtn:"sm",FirstTabName:"Inventario",SecondTabName:"Muerto"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}}),2===t.active?a("div",[a("div",{staticClass:"q-mt-md q-mb-md"}),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-3 text-center flex flex-center"},[a("notificationsCounterForIten",{attrs:{url:"inventory",num:0}}),a("q-icon",{attrs:{name:"inventory",size:"2rem",color:"red-6"},on:{click:function(e){t.showReEntry=!t.showReEntry}}}),t._m(0)],1),a("div",{staticClass:"col-3 text-center"},[a("q-icon",{attrs:{name:"assignment",size:"2rem",color:"red-6"},on:{click:function(e){t.showConfirmacion=!t.showConfirmacion}}}),t._m(1)],1),t._m(2)]),a("q-dialog",{model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("inventoryForm")],1)],1):t._e(),1===t.active?a("div",{staticClass:"q-mb-sm q-mt-sm"},[a("div",{staticClass:"q-mt-md q-mb-md"}),a("q-dialog",{model:{value:t.showModalDead,callback:function(e){t.showModalDead=e},expression:"showModalDead"}},[a("inventoryFormDead")],1),a("q-table",{attrs:{title:"Inventario","no-data-label":"Sin Resultado",data:t.rows,columns:t.columns,"row-key":"step"},scopedSlots:t._u([{key:"top-right",fn:function(){return[a("q-btn",{attrs:{color:"deep-purple-5",icon:"inventory","no-caps":"",round:"",push:""},on:{click:function(e){t.showModalDead=!t.showModalDead}}})]},proxy:!0},{key:"body-cell-quantity",fn:function(e){return[a("q-td",{attrs:{props:e}},[a("q-badge",{attrs:{color:t.quantityColor(e.row.quantity)}},[a("div",{staticClass:"my-table-details text-white "},[t._v("\n                "+t._s(e.row.quantity)+"\n              ")])])],1)]}},{key:"body-cell-dead",fn:function(e){return[a("q-td",{attrs:{props:e}},[a("q-badge",{attrs:{color:"deep-purple-5"}},[a("div",{staticClass:"my-table-details text-white "},[t._v("\n                "+t._s(e.row.dead)+"\n              ")])])],1)]}}],null,!1,841126343)}),a("q-dialog",{model:{value:t.showModalReturn,callback:function(e){t.showModalReturn=e},expression:"showModalReturn"}},[a("inventoryDemandReturn")],1)],1):t._e(),1==t.active&&0==t.showDemandReturn?a("q-list",{attrs:{dark:"",bordered:"",separator:""}}):t._e(),1==t.active&&1==t.showDemandReturn?a("q-list",{attrs:{dark:"",bordered:"",separator:""}},[a("q-input",{attrs:{standout:"",disable:"",readonly:"",label:"Numero de Control"},model:{value:t.numbControl,callback:function(e){t.numbControl=e},expression:"numbControl"}}),a("q-separator",{staticClass:"q-mb-sm q-mt-sm"}),t._l(t.materials,(function(t,e){return a("inventoryDemandCardReturn",{key:e,attrs:{material:t}})}))],2):t._e(),2==t.active?a("q-list",{attrs:{dark:"",bordered:"",separator:""}},[a("q-table",{attrs:{title:"Inventario","no-data-label":"Sin Resultado",data:t.rows,columns:t.columns,"row-key":"step"},scopedSlots:t._u([{key:"top-right",fn:function(){},proxy:!0},{key:"body-cell-quantity",fn:function(e){return[a("q-td",{attrs:{props:e}},[a("q-badge",{attrs:{color:t.quantityColor(e.row.quantity)}},[a("div",{staticClass:"my-table-details text-white "},[t._v("\n                "+t._s(e.row.quantity)+"\n              ")])])],1)]}},{key:"body-cell-material",fn:function(e){return[a("q-td",{attrs:{props:e}},[t._v("\n            "+t._s(e.row.material)+"\n            "),a("q-popup-edit",{model:{value:e.row.material,callback:function(a){t.$set(e.row,"material",a)},expression:"props.row.material"}},[a("q-input",{attrs:{dense:"",autofocus:"",counter:""},model:{value:e.row.material,callback:function(a){t.$set(e.row,"material",a)},expression:"props.row.material"}})],1)],1)]}}],null,!1,2296563983)})],1):t._e(),a("q-dialog",{model:{value:t.showAlert,callback:function(e){t.showAlert=e},expression:"showAlert"}},[a("inventoryForm")],1),a("q-dialog",{staticClass:"flex flex-center",attrs:{maximized:t.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.showReEntry,callback:function(e){t.showReEntry=e},expression:"showReEntry"}},[a("reEntry")],1),a("q-dialog",{staticClass:"flex flex-center",attrs:{maximized:t.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.showConfirmacion,callback:function(e){t.showConfirmacion=e},expression:"showConfirmacion"}},[a("confirmation")],1)],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("small",[a("strong",[t._v("Ingresos")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("small",[a("strong",[t._v("Confirmaciones")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-6"},[a("div",{staticClass:"text-right"})])}],s=a("c973"),l=a.n(s),c=(a("159b"),a("b0c0"),a("ac1f"),a("841c"),a("4de4"),a("96cf"),a("d784d")),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"flex flex-center"},[a("div",{staticClass:"text-h6 text-black"},[t._v("Nuevo Iten")])]),a("q-card-section",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[a("div",[a("q-input",{attrs:{outlined:"",type:"text",label:"Nombre","label-color":"black"},model:{value:t.inventory.name,callback:function(e){t.$set(t.inventory,"name",e)},expression:"inventory.name"}})],1),a("div",[a("q-select",{attrs:{outlined:"","options-dark":"","label-color":"black",options:t.meaures,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"measure"in t?t.measure:"- Null -"},label:"Medida","emit-value":"","map-options":""},model:{value:t.inventory.measure_id,callback:function(e){t.$set(t.inventory,"measure_id",e)},expression:"inventory.measure_id"}})],1)])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:t.inventory.id?"Actualizar":"guardar",color:"green",loading:t.loading},on:{click:t.validate}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1)],1)},d=[],m=(a("bc3a"),a("ae33")),h={data:function(){return{show:!1,loading:!1}},props:{inventory:{type:Object,default:function(){return{id:null,name:null,quantity:0,measure_id:null}}}},computed:{meaures:{get:function(){return this.$store.getters["measures/measures"]}}},methods:{initialize:function(){this.inventory.id=this.inventory.id?this.inventory.id:null,this.inventory.name=this.inventory.id?this.inventory.name:null,this.inventory.measure_id=this.inventory.id?this.inventory.measure_id:null},store:function(){this.loading=!0,this.inventory.id?this.update():this.create()},create:function(){var t=this,e=new FormData;e.append("name",this.inventory.name),e.append("quantity",this.inventory.quantity),e.append("measure_id",this.inventory.measure_id),this.$store.dispatch("inventory/store",e).then((function(e){t.$q.notify({message:"Guardado con exitos",color:"green",position:"right"}),t.show=!1,t.$root.$emit("inventory_refresh")})).catch((function(t){console.log(t)}))},update:function(){var t=this;this.$store.dispatch("inventory/update",this.inventory).then((function(e){console.log(e.data),t.$q.notify({message:"actualizado con exitos",color:"green",position:"right"}),t.$root.$emit("updateInventoryDone")})).catch((function(t){console.log(t)}))},cerrar:function(){this.$root.$emit("users_refresh"),this.$root.$emit("updateDone")},NotNull:m["a"],validate:function(){this.NotNull([{val:this.inventory.name,message:"Debe colocar nombre al producto"},{val:this.inventory.measure_id,message:"Seleccione una Unidad de Medida"}],this.store)}},mounted:function(){this.initialize()}},p=h,f=a("2877"),v=a("f09f"),b=a("a370"),_=a("0378"),w=a("27f9"),y=a("ddd8"),q=a("4b7e"),g=a("9c40"),x=a("7f67"),C=a("eebe"),k=a.n(C),$=Object(f["a"])(p,u,d,!1,null,null,null),I=$.exports;k()($,"components",{QCard:v["a"],QCardSection:b["a"],QForm:_["a"],QInput:w["a"],QSelect:y["a"],QCardActions:q["a"],QBtn:g["a"]}),k()($,"directives",{ClosePopup:x["a"]});var N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"item-vel full-width",attrs:{clickable:""}},[a("div",{staticClass:"row full-width"},[a("div",{staticClass:"col-3"},[a("q-item-section",[t._v(" "+t._s("Nombre : ")+" "+t._s(t.inventory.name))])],1),a("div",{staticClass:"col-3"},[a("q-item-section",[t._v(t._s("Cantidad : ")+" "+t._s(t.inventory.quantity))])],1),a("div",{staticClass:"col-3"},[a("q-item-section",[t._v(t._s("Medida : ")+" "+t._s(t.inventory.measure.measure))])],1),1==t.tab?a("div",{staticClass:"col-3"},[a("q-item-section",[t._v(t._s("Muerto : ")+" "+t._s(t.inventory.dead))])],1):t._e(),a("div",{staticClass:"col-3"},[1==t.tab?a("q-btn",{attrs:{flat:"",dense:"",icon:"edit"},on:{click:function(e){t.showFormQuantity=!t.showFormQuantity}}}):t._e(),2==t.tab?a("q-btn",{attrs:{flat:"",dense:"",icon:"edit"},on:{click:function(e){t.showForm=!t.showForm}}}):t._e()],1)])]),a("q-dialog",{model:{value:t.showFormQuantity,callback:function(e){t.showFormQuantity=e},expression:"showFormQuantity"}},[a("quantityForm",{attrs:{inventory:t.inventory}})],1),a("q-dialog",{model:{value:t.showForm,callback:function(e){t.showForm=e},expression:"showForm"}},[a("inventoryForm",{attrs:{inventory:t.inventory}})],1)],1)},S=[],Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"flex flex-center"},[a("div",{staticClass:"text-h6 text-black"},[t._v("Nuevo Iten")])]),a("q-card-section",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[a("div",[a("q-input",{attrs:{outlined:"",type:"text",label:"Nombre","label-color":"black"},model:{value:t.inventory.name,callback:function(e){t.$set(t.inventory,"name",e)},expression:"inventory.name"}})],1),a("div",[a("q-input",{attrs:{outlined:"",type:"text",label:"Cantidad","label-color":"black"},model:{value:t.dead,callback:function(e){t.dead=e},expression:"dead"}})],1)])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:t.inventory.id?"guardar":"Actualizar",color:"green",loading:t.loading},on:{click:t.store}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1)],1)},E=[],M=(a("a9e3"),{data:function(){return{show:!1,loading:!1,dead:"",updateIventory:{}}},props:{inventory:{type:Object,default:function(){return{id:null,name:null,quantity:0,measure_id:null,dead:0}}},material:{type:Object,default:""}},computed:{meaures:{get:function(){return this.$store.getters["measures/measures"]}}},methods:{armarObejt:function(t){this.updateIventory=1==t?{id:this.inventory.id,name:this.inventory.name,quantity:this.inventory.quantity,dead:this.inventory.dead,idMaterial:this.material.id,quantityMaterial:this.material.quantity}:{id:this.inventory.id,name:this.inventory.name,quantity:this.inventory.quantity,dead:this.inventory.dead}},store:function(){this.material&&Number(this.dead)>Number(this.material.quantity)?this.$q.notify({message:"La cantidad es mayor al que solicito ",color:"red",position:"right"}):this.updateDemandReturnDead()},create:function(){var t=this,e=new FormData;e.append("name",this.inventory.name),e.append("quantity",this.inventory.quantity),e.append("measure_id",this.inventory.measure_id),this.$store.dispatch("inventory/store",e).then((function(e){t.$q.notify({message:"Guardado con exitos",color:"green",position:"right"}),t.show=!1,t.$root.$emit("inventory_refresh")})).catch((function(t){console.log(t)}))},update:function(){var t=this;this.$store.dispatch("inventory/updateItemDead",this.inventory).then((function(e){console.log(e.data),t.$q.notify({message:"actualizado con exitos",color:"green",position:"right"}),t.$root.$emit("updateInventoryDone")})).catch((function(t){console.log(t)}))},updateDemandReturnDead:function(){var t=this,e="";this.material?(this.material.quantity=Number(this.material.quantity)-Number(this.dead),this.inventory.dead=Number(this.inventory.dead)+Number(this.dead),this.armarObejt(1),e="inventory/updateMaterialDemandReturnDead"):(this.inventory.dead=Number(this.inventory.dead)+Number(this.dead),this.armarObejt(2),e="inventory/updateDemandReturnDead"),console.log("Inventori",this.updateIventory,"link ",e),this.$store.dispatch(e,this.updateIventory).then((function(e){t.$q.notify({message:"Actualizado con exitos",color:"green",position:"right"}),t.material?t.$root.$emit("updateDemandReturn"):t.$root.$emit("updateDead")})).catch((function(t){console.log(t)}))},NotNull:m["a"],validate:function(){this.NotNull([{val:this.dead,message:"Debe colocar una cantidad"}],this.store)}},mounted:function(){console.log(this.inventory)}}),D=M,O=Object(f["a"])(D,Q,E,!1,null,null,null),P=O.exports;k()(O,"components",{QCard:v["a"],QCardSection:b["a"],QForm:_["a"],QInput:w["a"],QCardActions:q["a"],QBtn:g["a"]}),k()(O,"directives",{ClosePopup:x["a"]});var A={data:function(){return{showForm:!1,showDelete:!1,showFormQuantity:!1,rows:[],columns:[]}},props:["inventory","tab"],components:{quantityForm:P,inventoryForm:I},methods:{columRow:function(t){this.columns=[{name:"material",label:"Materiales",align:"center",field:"material",sortable:!0},{name:"um",label:"UM",align:"center",field:"um",sortable:!0},{name:"quantity",label:"Cantidad",align:"center",field:"quantity",sortable:!0},{name:"step",label:"Status",align:"center",field:"step",sortable:!0}];var e=this;this.search.materials.forEach((function(t){var a={material:t.name,um:t.measure.measure,quantity:t.quantity,step:t.status_id};e.rows.push(a)}))}},mounted:function(){var t=this;this.$root.$on("updateInventoryDone",(function(){t.showForm=!1,t.$root.$emit("inventory_refresh")})),this.$root.$on("updateDead",(function(){t.showForm=!1}))}},R=A,F=a("66e5"),j=a("4074"),T=a("24e8"),z=a("714f"),L=Object(f["a"])(R,N,S,!1,null,null,null),B=L.exports;k()(L,"components",{QItem:F["a"],QItemSection:j["a"],QBtn:g["a"],QDialog:T["a"]}),k()(L,"directives",{Ripple:z["a"]});var V=a("4819"),U=a("cf46"),Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"flex flex-center"},[a("div",{staticClass:"text-h6 text-black"},[t._v("Nuevo")])]),a("q-card-section",[t.showAddProduct?t._e():a("q-form",{staticClass:"aboo_form q-gutter-sm "},[a("div",{staticClass:"text-black"},[t._v("\n            Materiales "),t.showIcon?a("q-btn",{staticClass:"bg-blue",attrs:{rounded:"",icon:"add"},on:{click:function(e){t.showAddProduct=!t.showAddProduct}}}):t._e(),a("div",[t.new_materials.length>0?a("q-list",{staticStyle:{"max-width":"318px"},attrs:{bordered:"",separator:""}},t._l(t.new_materials,(function(e,n){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{clickable:""}},[a("q-item-section",[t._v(" "+t._s(e.name?e.name:e[0].name)+", "+t._s(e.quantity?e.quantity:e[0].quantity))]),t.showIcon?a("q-item-section",[a("q-btn",{attrs:{flat:"",icon:"delete"}})],1):t._e()],1)})),1):t._e()],1)],1)]),t.showAddProduct&&!1===t.showAddProductNew?a("div",[t.inputShow?t._e():a("q-input",{attrs:{outlined:"",clearable:"",type:"text",label:"Nombre Producto"},model:{value:t.productName,callback:function(e){t.productName=e},expression:"productName"}}),t.inputShow?a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.inventories_filter,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"name"in t?t.name:""},"use-input":"",label:"Materiales"},on:{filter:t.filter_invetories},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{},[t._v("\n                    no hay resultados\n                    "),a("q-btn",{staticClass:"bg-blue",attrs:{icon:"add",label:"agregar producto"},on:{click:function(e){t.inputShow=!t.inputShow}}})],1)],1)]},proxy:!0}],null,!1,453250717),model:{value:t.material,callback:function(e){t.material=e},expression:"material"}}):t._e(),t.inputShow?t._e():a("div",[a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.measure_filter,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"measure"in t?t.measure:""},"emit-value":"","map-options":"",label:"Unidades de Medida"},on:{filter:t.filter_measure},model:{value:t.measureModel,callback:function(e){t.measureModel=e},expression:"measureModel"}})],1),a("q-input",{attrs:{outlined:"",type:"number",label:"Unidades"},model:{value:t.productNr,callback:function(e){t.productNr=e},expression:"productNr"}}),a("q-btn",{staticClass:"primary full-width",attrs:{label:"agregar",color:"primary"},on:{click:t.set_materials}}),a("q-btn",{staticClass:"btn-danger full-width",attrs:{label:"Cancelar",color:"red"},on:{click:function(e){t.showAddProduct=!t.showAddProduct}}})],1):t._e()],1),a("q-card-actions",{attrs:{align:"right"}},[t.showIcon?a("q-btn",{attrs:{flat:"",label:t.demands._id?"Actualizar":"guardar",color:"green",loading:t.loading},on:{click:function(e){return t.store()}}}):t._e(),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1)],1)},G=[],H={name:"FormDemands",data:function(){return{show:!1,discipline:[],loading:!1,showAddProduct:!1,showAddProductNew:!1,productName:null,productNr:null,material:null,new_materials:[],measureModel:null,measure_filter:[],inventories_filter:[],showIcon:!0,inputShow:!0}},computed:{measures:{get:function(){return this.$store.getters["measures/measures"]}},inventories:{get:function(){return this.$store.getters["inventory/inventory"]}}},watch:{material:function(t,e){this.measureModel=t.measure_id},productName:function(t){null===t&&(this.inputShow=!0)}},props:{demands:{type:Object,default:function(){return{id:null,description:null,control_number:null,type:null,materials:[],new_materials:[]}}},inventory:{type:Object,default:function(){return{materials:[]}}}},methods:{iniciar:function(){this.show=!1,this.discipline=[],this.loading=!1,this.showAddProduct=!1,this.showAddProductNew=!1,this.productName=null,this.productNr=null,this.material=null,this.new_materials=[],this.measureModel=null,this.measure_filter=[],this.inventories_filter=[],this.showIcon=!0,this.inputShow=!0},filter_invetories:function(t,e,a){var n=this;this.productName=t,t.length<2?a():e(""!=t?function(){var e=t.toLowerCase();n.inventories_filter=n.inventories.filter((function(t){return t.name.toLowerCase().indexOf(e)>-1}))}:function(){n.inventories_filter=n.inventories})},filter_measure:function(t,e){var a=this;e(""!=t?function(){var e=t.toLowerCase();a.measure_filter=a.measures.filter((function(t){return t.measure.toLowerCase().indexOf(e)>-1}))}:function(){a.measure_filter=a.measures})},set_materials:function(){if(this.inputShow){var t={item_id:this.material.id,name:this.material.name,measure_id:this.measureModel,measure:this.measureModel,quantity:this.productNr,minimun:0};this.inventory.materials.push(t),this.new_materials.push(t),this.material=null,this.measureModel=null,this.productNr=null,this.showAddProductNew=!1,this.showAddProduct=!1,console.log("Inventory materials ",this.inventory.materials)}else this.set_new_materials()},set_new_materials:function(){var t={item_id:null,name:this.productName,measure_id:this.measureModel,measure:this.measureModel,quantity:this.productNr,dead:this.productNr,minimun:1};this.new_materials.push(t),this.inventory.materials.push(t),this.productName=null,this.measureModel=null,this.productNr=null,this.showAddProductNew=!1,this.showAddProduct=!1,console.log("Inventory materials  nuevo",this.inventory.materials)},showNewProduct:function(){this.showAddProductNew=!0,this.showAddProduct=!1},store:function(){0!=this.inventory.materials.length?(this.loading=!0,this.inventory.id?this.update():this.create()):this.$q.notify({message:"Debe agregar Material",color:"red",position:"right"})},create:function(){var t=this;this.$store.dispatch("inventory/updateDead",this.inventory).then((function(e){t.$q.notify({message:"Guardado con exitos",color:"green",position:"right"}),t.$root.$emit("inventory_refresh")})).catch((function(t){console.log(t)}))},update:function(){var t=this;axios.put("/demands/"+this.demands.id,this.demands).then((function(e){t.$q.notify({message:"actualizado con exitos",color:"green",position:"right"}),t.$root.$emit("demands_refresh")})).catch((function(t){console.log(t)}))}},mounted:function(){}},J=H,K=a("1c1c"),W=Object(f["a"])(J,Y,G,!1,null,null,null),X=W.exports;k()(W,"components",{QCard:v["a"],QCardSection:b["a"],QForm:_["a"],QBtn:g["a"],QList:K["a"],QItem:F["a"],QItemSection:j["a"],QInput:w["a"],QSelect:y["a"],QCardActions:q["a"]}),k()(W,"directives",{Ripple:z["a"],ClosePopup:x["a"]});var Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"flex flex-center"},[a("div",{staticClass:"text-h6 text-black"},[t._v("Numero de Control")])]),a("q-card-section",[a("q-input",{staticClass:"q-ml-md",attrs:{filled:"",label:"Numero de Control","input-class":"text-right"},scopedSlots:t._u([{key:"append",fn:function(){return[""===t.demand.control_number?a("q-icon",{attrs:{name:"search"}}):a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"},on:{click:function(e){return t.searchNumControl()}}})]},proxy:!0}]),model:{value:t.demand.control_number,callback:function(e){t.$set(t.demand,"control_number",e)},expression:"demand.control_number"}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1)],1)},tt=[],et={name:"SearchDemandsInventory",data:function(){return{loading:!1}},computed:{},watch:{},props:{demand:{type:Object,default:function(){return{control_number:null,materials:[]}}}},methods:{searchNumControl:function(){var t=this;this.$store.dispatch("demands/searchDemands",this.demand).then((function(e){console.log(e.data),0==e.data.length?t.$q.notify({message:"No se encontro resultado",color:"red",position:"right"}):t.$root.$emit("searchDemand",e.data[0])})).catch((function(t){console.log(t)}))}},mounted:function(){console.log(this.demand)}},at=et,nt=a("0016"),ot=Object(f["a"])(at,Z,tt,!1,null,null,null),it=ot.exports;k()(ot,"components",{QCard:v["a"],QCardSection:b["a"],QInput:w["a"],QIcon:nt["a"],QCardActions:q["a"],QBtn:g["a"]}),k()(ot,"directives",{ClosePopup:x["a"]});var rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"item-vel full-width",attrs:{clickable:""}},[a("div",{staticClass:"row full-width"},[a("div",{staticClass:"col-3"},[a("q-item-section",[t._v(" "+t._s("Nombre : ")+" "+t._s(t.material.inventory.name?t.material.inventory.name:""))])],1),a("div",{staticClass:"col-3"},[a("q-item-section",[t._v(t._s("Cantidad : ")+" "+t._s(t.material.quantity))])],1),a("div",{staticClass:"col-3"},[a("q-item-section",[t._v(t._s("Medida : ")+" "+t._s(t.material.measure.measure))])],1),a("div",{staticClass:"col-3"},[a("q-item-section",[t._v(t._s("Muerto : ")+" "+t._s(t.material.inventory.dead))])],1),a("div",{staticClass:"col-3"},[t.material.quantity>0?a("q-btn",{attrs:{flat:"",dense:"",icon:"edit"},on:{click:function(e){t.showForm=!t.showForm}}}):t._e()],1)])]),a("q-dialog",{model:{value:t.showForm,callback:function(e){t.showForm=e},expression:"showForm"}},[a("quantityForm",{attrs:{material:t.material,inventory:t.material.inventory}})],1)],1)},st=[],lt={data:function(){return{showForm:!1,showDelete:!1}},props:["material"],components:{quantityForm:P},methods:{},mounted:function(){var t=this;console.log("Materiales ",this.material),this.$root.$on("updateDemandReturn",(function(){t.showForm=!1}))}},ct=lt,ut=Object(f["a"])(ct,rt,st,!1,null,null,null),dt=ut.exports;k()(ut,"components",{QItem:F["a"],QItemSection:j["a"],QBtn:g["a"],QDialog:T["a"]}),k()(ut,"directives",{Ripple:z["a"]});var mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-input",{ref:"inputSearch",attrs:{dense:"",outlined:"",clearable:"",placeholder:"Que deseas buscar",color:"black","bg-color":"white"},on:{focus:function(e){t.showOptions=!0},blur:function(e){t.showOptions=!1},keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.SearchService()},function(e){return t.searchFilter()}]},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer text-secundary",attrs:{name:"search"},on:{click:function(e){return t.SearchService()}}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)},ht=[],pt={name:"inputSearch",data:function(){return{search:null,showOptions:!1}},props:["tab"],computed:{inventories:{get:function(){return this.$store.getters["inventory/inventory"]}}},watch:{},methods:{SearchService:function(){this.searchFilter()},searchFilter:function(){var t=this;if(""!=this.search){var e=this.inventories.filter((function(e){return e.name.toLowerCase().indexOf(t.search)>-1}));this.$root.$emit("searchFilter",e)}else this.$root.$emit("searchFilter",this.inventories)}},mounted:function(){}},ft=pt,vt=Object(f["a"])(ft,mt,ht,!1,null,null,null),bt=vt.exports;k()(vt,"components",{QInput:w["a"],QIcon:nt["a"]});var _t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-bar",{staticClass:"bg-primary "},[a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[t._v("Close")])],1)],1),a("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"flex flex-center"},[a("div",{staticClass:"text-h6 text-black"},[t._v("Ingresos")])]),a("q-card-section",[a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.options,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"name"in t?t.name:""},"emit-value":"","map-options":"",label:"Procedencia"},model:{value:t.optionValue,callback:function(e){t.optionValue=e},expression:"optionValue"}}),t.showDonacion?a("div",{staticClass:"q-mt-md"},[a("donacion")],1):t._e(),t.showPrestamo?a("div",{staticClass:"q-mt-md"},[a("prestamo")],1):t._e(),t.showOC?a("div",{staticClass:"q-mt-md"},[a("po")],1):t._e(),t.showReIngreso?a("div",[a("reEntry")],1):t._e()],1)],1)],1)},wt=[],yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-input",{staticClass:"full-with q-mt-md",attrs:{filled:"","stack-label":"",label:"Numero de Control"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"},on:{click:function(e){return t.searchNumControl()}}})]},proxy:!0}]),model:{value:t.demand.control_number,callback:function(e){t.$set(t.demand,"control_number",e)},expression:"demand.control_number"}}),t.showTableMaterial?a("div",[a("div",{staticClass:"row q-pt-sm"},[a("div",{staticClass:"col-6"},[a("q-item-label",{staticClass:"text-black"},[t._v("Nombre(s) Apellido(s) :"),a("span",[a("strong",[t._v(" "+t._s(t.demand.request_user.name)+" "+t._s(t.demand.request_user.last_name)+"  ")])])])],1),a("div",{staticClass:"col-6"},[a("q-item-label",{staticClass:"text-black"},[t._v("Fecha / Hora :"),a("span",[a("strong",[t._v(" "+t._s(t._f("formatDate")(t.demand.created_at))+" /  "+t._s(t._f("formatTime")(t.demand.created_at))+"  ")])])])],1)]),a("div",{staticClass:"q-pt-md"},[a("q-table",{attrs:{title:"Materiales","no-data-label":"Sin Resultado",data:t.rows,columns:t.columns,"row-key":"step"},scopedSlots:t._u([{key:"body-cell-quantity",fn:function(e){return[a("q-td",{attrs:{props:e}},[a("q-badge",{attrs:{color:t.quantityColor(e.row.quantity)}},[a("div",{staticClass:"my-table-details text-black "},[t._v("\n                "+t._s(e.row.quantity)+"\n              ")])])],1)]}},{key:"body-cell-material",fn:function(e){return[a("q-td",{attrs:{props:e}},[t._v("\n            "+t._s(e.row.material)+"\n          ")])]}},{key:"body-cell-reEntry",fn:function(e){return[a("q-td",{attrs:{props:e}},[t._v("\n            "+t._s(e.row.reEntry)+"\n            "),a("q-popup-edit",{model:{value:e.row.reEntry,callback:function(a){t.$set(e.row,"reEntry",a)},expression:"props.row.reEntry"}},[a("q-input",{attrs:{dense:"",autofocus:"",counter:""},model:{value:e.row.reEntry,callback:function(a){t.$set(e.row,"reEntry",a)},expression:"props.row.reEntry"}})],1)],1)]}}],null,!1,295857303)})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:" guardar",color:"green"},on:{click:function(e){return t.guardar()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1):t._e()],1)},qt=[],gt=(a("1276"),a("a4d3"),a("e01a"),a("bd4c")),xt={data:function(){return{showReIngreso:!1,showOption:!0,showTableMaterial:!1,options:[{id:1,name:"Donacion"},{id:2,name:"Prestamos"},{id:3,name:"Orden de Comprar"},{id:4,name:"Sobrante/Reingreso"}],optionValue:"",controlNumber:"",columns:[],rows:[]}},props:{demand:{type:Object,default:function(){return{id:null,control_number:"",created_at:null,description:null,materials:[],request_user:{},step:{}}}}},computed:{},filters:{formatDate:function(t){var e=t.split("T"),a=e[0].split("-"),n=new Date(a[0],a[1],a[2]);return gt["a"].formatDate(n,"DD-MM-YYYY")},formatTime:function(t){var e=t.split("T"),a=e[1].split(":"),n=new Date(a[0],a[1]);return gt["a"].formatDate(n,"hh:mm:ss A")}},watch:{optionValue:function(t,e){console.log(t),4==t?(this.showReIngreso=!0,this.showOption=!1):(this.showOption=!0,this.showReIngreso=!1)},demand:function(t,e){console.log(t),console.log(this.demand)}},methods:{initializeTable:function(){this.columns=[],this.rows=[]},cargarDemand:function(t){this.demand.id=t.id,this.demand.control_number=t.control_number,this.demand.description=t.description,this.demand.materials=t.materials,this.demand.request_user=t.request_user,this.demand.step=t.step,this.demand.created_at=t.created_at},columnss:function(){this.columns=[{name:"material",label:"Materiales",align:"center",field:"material",sortable:!0},{name:"quantity",label:"Cantidad",align:"center",field:"quantity",sortable:!0},{name:"reEntry",label:"Reingreso",align:"center",field:"reEntry",sortable:!0},{name:"total",label:"Total",align:"center",field:"total",sortable:!0}]},searchNumControl:function(){var t=this;this.$store.dispatch("demands/searchDemands",this.demand).then((function(e){console.log(e.data),0==e.data.length?t.$q.notify({message:"No se encontro resultado",color:"red",position:"right"}):(t.cargarDemand(e.data[0]),t.columRow())})).catch((function(t){console.log(t)}))},columRow:function(){this.initializeTable(),this.showTableMaterial=!0,this.columnss();var t=this;this.demand.materials.forEach((function(e){var a={material:e.name,quantity:e.quantity,reEntry:e.re_entry,total:parseInt(e.quantity)+parseInt(e.re_entry),um:e.measure.measure,demandId:t.demand.id,materialId:e.id,inventoryId:null==e.inventory_id?0:e.inventory_id};t.rows.push(a)}))},quantityColor:function(t){var e="";return 0==t?e="red":t>=1&&t<=3?e="yellow-5":t>=4&&(e="positive"),e},guardar:function(){var t=this;this.rows.forEach((function(t){t.quantity=parseInt(t.quantity)-parseInt(t.reEntry)})),console.log(this.rows),this.$store.dispatch("inventory/reEntry",this.rows).then((function(e){t.$q.notify({message:"Guardado con exitos",color:"green",position:"right"}),t.$root.$emit("inventory_refresh"),console.log(e.data)})).catch((function(t){console.log(t)}))}},mounted:function(){}},Ct=xt,kt=a("0170"),$t=a("eaac"),It=a("db86"),Nt=a("58a81"),St=a("42a1"),Qt=Object(f["a"])(Ct,yt,qt,!1,null,null,null),Et=Qt.exports;k()(Qt,"components",{QInput:w["a"],QIcon:nt["a"],QItemLabel:kt["a"],QTable:$t["a"],QTd:It["a"],QBadge:Nt["a"],QPopupEdit:St["a"],QCardActions:q["a"],QBtn:g["a"]}),k()(Qt,"directives",{ClosePopup:x["a"]});var Mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[a("div",[a("q-input",{attrs:{outlined:"",type:"text",label:"Nombre","label-color":"black"},model:{value:t.donation.name,callback:function(e){t.$set(t.donation,"name",e)},expression:"donation.name"}}),a("q-input",{attrs:{outlined:"",type:"text",label:"Apellido","label-color":"black"},model:{value:t.donation.last_name,callback:function(e){t.$set(t.donation,"last_name",e)},expression:"donation.last_name"}})],1),a("div",{staticClass:"text-black"},[t._v("\n      Items "),a("q-btn",{staticClass:"bg-blue",attrs:{rounded:"",icon:"add"},on:{click:function(e){t.showAddProduct=!t.showAddProduct}}}),a("div",[t.donation.new_materials.length>0?a("q-list",{staticStyle:{"max-width":"318px"},attrs:{bordered:"",separator:""}},t._l(t.donation.new_materials,(function(e,n){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{clickable:""}},[a("q-item-section",[t._v(" "+t._s(e.name?e.name:e[0].name)+", "+t._s(e.quantity?e.quantity:e[0].quantity))]),a("q-item-section",[a("q-btn",{attrs:{flat:"",icon:"delete"}})],1)],1)})),1):t._e()],1)],1)]),t.showAddProduct&&!1===t.showAddProductNew?a("div",{staticClass:"q-mt-md"},[t.inputShow?t._e():a("q-input",{attrs:{outlined:"",clearable:"",type:"text",label:"Descripcion"},model:{value:t.productName,callback:function(e){t.productName=e},expression:"productName"}}),t.inputShow?a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.inventories_filter,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"name"in t?t.name:""},"use-input":"",label:"Items"},on:{filter:t.filter_invetories},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",{attrs:{clickable:""},on:{click:function(e){t.inputShow=!t.inputShow}}},[a("q-item-section",{staticClass:"text-grey"},[t._v("\n            no hay resultados, haga click aqui si quiere agregar nuevo\n          ")])],1)]},proxy:!0}],null,!1,1040532111),model:{value:t.materials_id,callback:function(e){t.materials_id=e},expression:"materials_id"}}):t._e(),a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.measure_filter,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"measure"in t?t.measure:""},"emit-value":"","map-options":"",label:"Unidades de Medida"},model:{value:t.measure_id,callback:function(e){t.measure_id=e},expression:"measure_id"}}),a("q-input",{attrs:{outlined:"",type:"number",label:"Cantidad"},model:{value:t.productNr,callback:function(e){t.productNr=e},expression:"productNr"}}),a("q-btn",{staticClass:"primary full-width",attrs:{label:"agregar",color:"primary"},on:{click:t.set_materials}}),a("q-btn",{staticClass:"btn-danger full-width",attrs:{label:"Cancelar",color:"red"},on:{click:function(e){t.showAddProduct=!t.showAddProduct}}})],1):t._e(),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Guardar",color:"green"},on:{click:t.store}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1)},Dt=[],Ot=(a("7db0"),{data:function(){return{showAddProduct:!1,showAddProductNew:!1,inputShow:!0,productNr:"",productName:"",inventories:[],measures:[],materials_id:"",measure_id:"",inventories_filter:[],measure_filter:[]}},watch:{productName:function(t){null===t&&(this.inputShow=!0)},materials_id:function(t){var e=this.inventories.find((function(e){return e.id===t.id}));this.measure_id=e.measure_id}},props:{donation:{type:Object,default:function(){return{description:null,name:null,last_name:null,new_materials:[],type:1}}}},computed:{},methods:{set_materials:function(){if(this.inputShow){var t={quantity:this.productNr,measureId:this.measure_id,materialId:this.materials_id.id,name:this.materials_id.name};this.donation.new_materials.push(t),this.showAddProductNew=!1,this.showAddProduct=!1,this.productNr=null,this.measure_id=null,this.productName=null}else this.set_new_materials()},set_new_materials:function(){var t={materialId:0,name:this.productName,measureId:this.measure_id,quantity:this.productNr};this.donation.new_materials.push(t),this.showAddProductNew=!1,this.showAddProduct=!1,this.productNr=null,this.measure_id=null,this.productName=null},store:function(){var t=this;console.log("Donation",this.donation),this.$q.loading.show(),this.$store.dispatch("inventory/donation",this.donation).then((function(e){t.$q.loading.hide(),t.$q.notify({message:"Guardado con exitos",color:"green",position:"right"}),t.$root.$emit("inventory_refresh")})).catch((function(t){console.log(t)}))},filter_invetories:function(t,e,a){var n=this;this.productName=t,t.length<2?a():e((function(){var e=t.toLowerCase();n.inventories_filter=n.inventories.filter((function(t){return t.name.toLowerCase().indexOf(e)>-1}))}))},getdiscipline:function(){var t=this;this.$q.loading.show(),axios.get("/demand/get_inventories").then((function(e){t.$q.loading.hide(),console.log(e),t.measures=e.data.measures,t.inventories=e.data.inventories,t.measure_filter=e.data.measures})).catch((function(e){console.log(e),t.$q.loading.hide()}))}},mounted:function(){}}),Pt=Ot,At=Object(f["a"])(Pt,Mt,Dt,!1,null,null,null),Rt=At.exports;k()(At,"components",{QForm:_["a"],QInput:w["a"],QBtn:g["a"],QList:K["a"],QItem:F["a"],QItemSection:j["a"],QSelect:y["a"],QCardActions:q["a"]}),k()(At,"directives",{Ripple:z["a"],ClosePopup:x["a"]});var Ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[a("div",[a("q-input",{attrs:{outlined:"",type:"text",label:"Nombre","label-color":"black"},model:{value:t.prestamo.name,callback:function(e){t.$set(t.prestamo,"name",e)},expression:"prestamo.name"}}),a("q-input",{attrs:{outlined:"",type:"text",label:"Apellido","label-color":"black"},model:{value:t.prestamo.last_name,callback:function(e){t.$set(t.prestamo,"last_name",e)},expression:"prestamo.last_name"}})],1),a("div",{staticClass:"text-black"},[t._v("\n      Items "),a("q-btn",{staticClass:"bg-blue",attrs:{rounded:"",icon:"add"},on:{click:function(e){t.showAddProduct=!t.showAddProduct}}}),a("div",[t.prestamo.new_materials.length>0?a("q-list",{staticStyle:{"max-width":"318px"},attrs:{bordered:"",separator:""}},t._l(t.prestamo.new_materials,(function(e,n){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:n,attrs:{clickable:""}},[a("q-item-section",[t._v(" "+t._s(e.name?e.name:e[0].name)+", "+t._s(e.quantity?e.quantity:e[0].quantity))]),a("q-item-section",[a("q-btn",{attrs:{flat:"",icon:"delete"}})],1)],1)})),1):t._e()],1)],1)]),t.showAddProduct&&!1===t.showAddProductNew?a("div",{staticClass:"q-mt-md"},[t.inputShow?t._e():a("q-input",{attrs:{outlined:"",clearable:"",type:"text",label:"Descripcion"},model:{value:t.productName,callback:function(e){t.productName=e},expression:"productName"}}),t.inputShow?a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.inventories_filter,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"name"in t?t.name:""},"use-input":"",label:"Materiales"},on:{filter:t.filter_invetories},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",{attrs:{clickable:""},on:{click:function(e){t.inputShow=!t.inputShow}}},[a("q-item-section",{staticClass:"text-grey"},[t._v("\n            no hay resultados, haga click aqui si quiere agregar nuevo\n          ")])],1)]},proxy:!0}],null,!1,1040532111),model:{value:t.materials_id,callback:function(e){t.materials_id=e},expression:"materials_id"}}):t._e(),a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.measure_filter,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"measure"in t?t.measure:""},"emit-value":"","map-options":"",label:"Unidades de Medida"},model:{value:t.measure_id,callback:function(e){t.measure_id=e},expression:"measure_id"}}),a("q-input",{attrs:{outlined:"",type:"number",label:"Cantidad"},model:{value:t.productNr,callback:function(e){t.productNr=e},expression:"productNr"}}),a("q-btn",{staticClass:"primary full-width",attrs:{label:"agregar",color:"primary"},on:{click:t.set_materials}}),a("q-btn",{staticClass:"btn-danger full-width",attrs:{label:"Cancelar",color:"red"},on:{click:function(e){t.showAddProduct=!t.showAddProduct}}})],1):t._e(),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Guardar",color:"green"},on:{click:t.store}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1)},jt=[],Tt={data:function(){return{showAddProduct:!1,showAddProductNew:!1,inputShow:!0,productNr:"",productName:"",inventories:[],measures:[],materials_id:"",measure_id:"",inventories_filter:[],measure_filter:[]}},watch:{productName:function(t){null===t&&(this.inputShow=!0)},materials_id:function(t){var e=this.inventories.find((function(e){return e.id===t.id}));this.measure_id=e.measure_id}},props:{prestamo:{type:Object,default:function(){return{description:null,name:null,last_name:null,new_materials:[],type:2}}}},computed:{},methods:{set_materials:function(){if(this.inputShow){var t={quantity:this.productNr,measureId:this.measure_id,materialId:this.materials_id.id,name:this.materials_id.name};this.prestamo.new_materials.push(t),this.showAddProductNew=!1,this.showAddProduct=!1,this.productNr=null,this.measure_id=null,this.productName=null}else this.set_new_materials();console.log(this.prestamo)},set_new_materials:function(){var t={materialId:0,name:this.productName,measureId:this.measure_id,quantity:this.productNr};this.prestamo.new_materials.push(t),this.showAddProductNew=!1,this.showAddProduct=!1,this.productNr=null,this.measure_id=null,this.productName=null},store:function(){var t=this;console.log("Prestamos",this.prestamo),this.$q.loading.show(),this.$store.dispatch("inventory/prestamo",this.prestamo).then((function(e){t.$q.loading.hide(),t.$q.notify({message:"Guardado con exitos",color:"green",position:"right"}),t.$root.$emit("inventory_refresh")})).catch((function(t){console.log(t)}))},filter_invetories:function(t,e,a){var n=this;this.productName=t,t.length<2?a():e((function(){var e=t.toLowerCase();n.inventories_filter=n.inventories.filter((function(t){return t.name.toLowerCase().indexOf(e)>-1}))}))},getdiscipline:function(){var t=this;this.$q.loading.show(),axios.get("/demand/get_inventories").then((function(e){t.$q.loading.hide(),t.measures=e.data.measures,t.inventories=e.data.inventories,t.measure_filter=e.data.measures})).catch((function(e){console.log(e),t.$q.loading.hide()}))}},mounted:function(){this.getdiscipline()}},zt=Tt,Lt=Object(f["a"])(zt,Ft,jt,!1,null,null,null),Bt=Lt.exports;k()(Lt,"components",{QForm:_["a"],QInput:w["a"],QBtn:g["a"],QList:K["a"],QItem:F["a"],QItemSection:j["a"],QSelect:y["a"],QCardActions:q["a"]}),k()(Lt,"directives",{Ripple:z["a"],ClosePopup:x["a"]});var Vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.orders.length>0?a("q-list",{staticClass:"text-black",attrs:{dark:"",bordered:"",separator:""}},t._l(t.orders,(function(e,n){return 1==e.status?a("poCard",{key:n,attrs:{order:e}}):t._e()})),1):a("q-list",{staticClass:"text-black",attrs:{dark:"",bordered:"",separator:""}},[t._v("\n     Sin orden que procesar\n  ")]),a("q-card-actions",{attrs:{align:"right"}})],1)},Ut=[],Yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-expansion-item",{attrs:{"expand-separator":"","header-class":" bg-blue-grey-11 text-blue"},scopedSlots:t._u([{key:"header",fn:function(){return[a("q-item-section",[t.hiddenNotifi?a("notificationsCounterForIten",{attrs:{url:"inventory",num:t.order.id,cargarNotifi:5}}):t._e(),a("q-item-label",{staticClass:"text-black"},[t._v("Orden de Compra N # : "),a("strong",[t._v(" "+t._s(t.formatId(t.order.id)))])]),a("q-item-label",{staticClass:"text-black"},[t._v(" N # : "),a("strong",[t._v(" "+t._s(t.formatId(t.order.id)))])]),a("q-item-label",{staticClass:"text-black"},[t._v("Fecha :"),a("span",{},[a("strong",[t._v(" "+t._s(t._f("formatDate")(t.order.created_at))+" ")])])]),a("q-item-label",{staticClass:"text-black"},[t._v("Hora :"),a("span",{},[a("strong",[t._v(" "+t._s(t._f("formatTime")(t.order.created_at)))])])]),1==t.order.special_permission?a("q-item-label",{staticClass:"text-black"},[t._v("Permiso Especial"),a("span",{},[a("strong",[t._v(" Activado ")])])]):t._e()],1)]},proxy:!0}])},[a("q-card-section",{staticClass:"q-mt-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 q-pa-sm"},[a("q-btn",{staticClass:"aboo_btn bg-green full-width",attrs:{label:"Agregar al Inventario"},on:{click:function(e){return t.ModalQuantity(t.order.id)}}})],1)]),0==t.order.special_permission?a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 q-pa-sm"},[a("q-btn",{staticClass:"aboo_btn bg-green full-width",attrs:{label:"Permiso Especial"},on:{click:function(e){return t.showPermisoEspeciall(t.order.id)}}})],1)]):t._e()])],1),a("q-space",{staticClass:"q-mt-md"}),a("q-dialog",{staticClass:"flex flex-center ",attrs:{persistent:"",maximized:t.maximizedToggle},model:{value:t.showModalQuantity,callback:function(e){t.showModalQuantity=e},expression:"showModalQuantity"}},[a("q-card",{staticClass:"modal-card"},[a("q-card-section",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"text-subtitle2"},[t._v("Materiales")])]),a("q-separator"),a("div",[a("q-card-section",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.options,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"name"in t?t.name:""},"emit-value":"","map-options":"",label:"Recibo de:",disable:""},model:{value:t.optionValue,callback:function(e){t.optionValue=e},expression:"optionValue"}}),t.showInterno?a("div",[a("div"),a("div",[a("q-input",{attrs:{disable:"",type:"text",label:"Nombre","label-color":"black"},model:{value:t.nameInterno,callback:function(e){t.nameInterno=e},expression:"nameInterno"}})],1),a("div",[a("q-input",{attrs:{disable:"",type:"text",label:"Apellido","label-color":"black"},model:{value:t.last_nameInterno,callback:function(e){t.last_nameInterno=e},expression:"last_nameInterno"}})],1)]):t._e(),t.showExterno?a("div",[a("div",[a("q-input",{attrs:{type:"text",label:"Nombre",hint:"Nombre Obligatorio","label-color":"black"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("div",[a("q-input",{attrs:{type:"text",label:"Apellido",hint:"Apellido Obligatorio","label-color":"black"},model:{value:t.last_name,callback:function(e){t.last_name=e},expression:"last_name"}})],1),a("div",[a("q-input",{attrs:{type:"text",label:"Cedula",hint:"Cedula Obligatorio","label-color":"black"},model:{value:t.cedula,callback:function(e){t.cedula=e},expression:"cedula"}})],1)]):t._e(),a("div",[a("strong",[t._v("Responsable : "+t._s(t.user.name)+" "+t._s(t.user.last_name))])]),a("div",[a("iniciedFile",{attrs:{request:t.order}})],1)],1)],1),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 q-pa-sm"},[a("q-checkbox",{attrs:{color:"secondary",label:"Todos","true-value":"si","false-value":"no"},model:{value:t.allQuantity,callback:function(e){t.allQuantity=e},expression:"allQuantity"}})],1),a("div",{staticClass:"col-6 text-right q-pa-sm "})]),a("form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.saveDemandMaterial(e)}}},[t._l(t.rows,(function(e,n){return a("q-card-section",{key:n},[a("div",{staticClass:"text-h6 text-primary"},[a("q-input",{ref:"quantityInput",refInFor:!0,attrs:{label:e.material+" ( Cant :"+e.quantity+" ) ","stack-label":"",rules:[function(t){return!!t||"* Obligatorio"},function(t){return t<=e.quantity||"La cantidad debe ser menor o igual que "+e.quantity}],disable:e.quantity===e.cantSelected},model:{value:e.cantSelected,callback:function(a){t.$set(e,"cantSelected",a)},expression:"material.cantSelected"}})],1)])})),t.showMotivo?a("q-card-section",[a("div",[a("q-input",{attrs:{filled:"",type:"textarea",label:"Motivo por las cantidades faltantes?"},model:{value:t.motivo,callback:function(e){t.motivo=e},expression:"motivo"}})],1)]):t._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 q-pa-sm"},[a("q-btn",{staticClass:"aboo_btn bg-green full-width",attrs:{label:"Guardar",type:"submit"}})],1),a("div",{staticClass:"col-6 q-pa-sm"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"aboo_btn  bg-red-4 full-width",attrs:{label:"Cancelar"}})],1)])],2)],1)],1)],1),a("q-dialog",{staticClass:"flex flex-center ",attrs:{persistent:""},model:{value:t.showPermisoEspecial,callback:function(e){t.showPermisoEspecial=e},expression:"showPermisoEspecial"}},[a("q-card",{staticClass:"modal-card"},[a("q-card-section",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"text-subtitle2"},[t._v("Permiso Especial ")])]),a("q-separator"),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 q-pa-sm"},[a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.userFilter,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"name"in t?t.name+" "+t.last_name:""},"use-input":"",label:"Nombre y Apellido"},on:{filter:t.filter_user},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",{attrs:{clickable:""}},[a("q-item-section",{staticClass:"text-grey"},[t._v("\n                    no hay resultados\n                  ")])],1)]},proxy:!0}]),model:{value:t.userSeleted,callback:function(e){t.userSeleted=e},expression:"userSeleted"}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 q-pa-sm"},[a("q-btn",{staticClass:"aboo_btn bg-green full-width",attrs:{label:"aceptar"},on:{click:function(e){return t.special_permission()}}})],1),a("div",{staticClass:"col-6 q-pa-sm"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"aboo_btn  bg-red-4 full-width",attrs:{label:"Cancelar"}})],1)])],1)],1),a("q-dialog",{staticClass:"flex flex-center ",attrs:{persistent:"",maximized:t.maximizedToggle},model:{value:t.showNotaEntrega,callback:function(e){t.showNotaEntrega=e},expression:"showNotaEntrega"}},[a("q-card",{staticClass:"modal-card"},[a("q-card-section",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"text-subtitle2"},[t._v("Nota de Entrega")])]),a("q-separator"),a("div",[a("q-card-section",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[a("div",[a("strong",[t._v("Yo: "+t._s(t.user.name)+" "+t._s(t.user.last_name)+" recibo de:")])]),t.showInterno?a("div",[a("div"),a("div",[a("q-input",{attrs:{disable:"",type:"text",label:"Nombre","label-color":"black"},model:{value:t.nameInterno,callback:function(e){t.nameInterno=e},expression:"nameInterno"}})],1),a("div",[a("q-input",{attrs:{disable:"",type:"text",label:"Apellido","label-color":"black"},model:{value:t.last_nameInterno,callback:function(e){t.last_nameInterno=e},expression:"last_nameInterno"}})],1)]):t._e(),t.showExterno?a("div",[a("div",[a("q-input",{attrs:{type:"text",label:"Nombre","label-color":"black",readonly:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("div",[a("q-input",{attrs:{type:"text",label:"Apellido","label-color":"black",readonly:""},model:{value:t.last_name,callback:function(e){t.last_name=e},expression:"last_name"}})],1),a("div",[a("q-input",{attrs:{type:"text",label:"Cedula","label-color":"black",readonly:""},model:{value:t.cedula,callback:function(e){t.cedula=e},expression:"cedula"}})],1)]):t._e(),a("div",[a("strong",[t._v("los siguientes materiales: ")])]),a("div",[a("showFile",{attrs:{request:t.order}})],1)])],1),a("form",[t._l(t.rows,(function(e,n){return a("q-card-section",{key:n},[a("div",{staticClass:"text-h6 text-primary"},[a("q-input",{ref:"quantityInput",refInFor:!0,attrs:{label:e.material+" ( Cant :"+e.quantity+" ) ","stack-label":"",rules:[function(t){return!!t||"* Obligatorio"},function(t){return t<=e.quantity||"La cantidad debe ser menor o igual que "+e.quantity}],disable:!0},model:{value:e.cantSelected,callback:function(a){t.$set(e,"cantSelected",a)},expression:"material.cantSelected"}})],1)])})),t.showMotivo?a("q-card-section",[a("div",[a("q-input",{attrs:{filled:"",type:"textarea",label:"Motivo por las cantidades faltantes?"},model:{value:t.motivo,callback:function(e){t.motivo=e},expression:"motivo"}})],1)]):t._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 q-pa-sm"},[a("q-btn",{staticClass:"aboo_btn  bg-green full-width",attrs:{label:"Salir"},on:{click:function(e){return t.reset()}}})],1)])],2)],1)],1)],1)],1)},Gt=[],Ht=a("0a83"),Jt=a("eaa6"),Kt=a("e93a"),Wt={data:function(){return{active:1,name:"",last_name:"",nameInterno:"",last_nameInterno:"",cedula:"",userSeleted:"",userFilter:[],options:[{id:1,name:"Interno"},{id:2,name:"Externo"}],optionValue:"",showInterno:!1,showExterno:!1,showMotivo:!1,showPermisoEspecial:!1,showNotaEntrega:!1,motivo:"",showModalQuantity:!1,maximizedToggle:!0,hiddenNotifi:!0,rows:[],columns:[],selected:[],allQuantity:"si",userResponsable:[],specialPermission:[]}},components:{tabs:V["a"],iniciedFile:Ht["a"],showFile:Jt["a"],notificationsCounterForIten:Kt["a"]},props:["order"],computed:{user:{get:function(){return this.$store.getters["auth/user"]}},users:{get:function(){return this.$store.getters["users/users"]}}},filters:{formatDate:function(t){var e=t.split("T"),a=e[0].split("-"),n=new Date(a[0],a[1],a[2]);return gt["a"].formatDate(n,"DD-MM-YYYY")},formatTime:function(t){var e=t.split("T"),a=e[1].split(":"),n=new Date(a[0],a[1]);return gt["a"].formatDate(n,"hh:mm:ss A")}},watch:{allQuantity:function(t){"si"==t?(this.showMotivo=!1,console.log(this.rows),this.rows.forEach((function(t){1==t.quantity?t.cantSelected=t.quantity:t.quantity==t.quantitySeleted?t.cantSelected=t.quantitySeleted:t.cantSelected=t.quantity}))):(this.showMotivo=!0,this.rows.forEach((function(t){t.cantSelected=0})))},optionValue:function(t,e){switch(this.name="",this.last_name="",this.userSeleted="",t){case 1:this.showInterno=!0,this.showExterno=!1;break;case 2:this.showInterno=!1,this.showExterno=!0;break}},userSeleted:function(t,e){console.log("User Selected",t),console.log("User Activo",this.user)}},methods:{special_permission:function(){var t=this,e={orderId:this.order.id,user_request:this.userSeleted};this.specialPermission.push(e),this.$q.loading.show(),this.$store.dispatch("order/special_permission",this.specialPermission).then((function(e){t.$q.notify({message:"Permiso Especial Aceptada",color:"green",position:"right"}),t.$q.loading.hide(),t.showPermisoEspecial=!1,t.$root.$emit("refresh_order_innventory"),console.log(e.data)})).catch((function(t){console.log(t)}))},filter_user:function(t,e,a){var n=this;t.length<2?a():e((function(){var e=t.toLowerCase();n.userFilter=n.users.filter((function(t){return t.name.toLowerCase().indexOf(e)>-1}))}))},formatId:function(t){for(var e=String(t),a="#",n=4-e.length,o=0;o<n;o++)a+="0";return a+e},cargarTable:function(){var t=this;this.rows=[];var e=this;this.order.applicants.forEach((function(a){var n={material:a.material.name,quantityTotal:a.material.quantity,quantity:a.material.quantity-a.material.quantity_selected_po,quantitySeleted:a.material.quantity_selected_po,price:a.price,id:a.id,orderId:t.order.id,materialId:a.material_id,inventoryId:null==a.material.inventory_id?0:a.material.inventory_id,cantSelected:a.material.quantity,measureId:a.material.measure_id,quantityEntregada:a.material.quantity_selected,demand_id:a.acp.demand_id};e.rows.push(n)}))},ModalQuantity:function(t){this.showModalQuantity=!0,this.$store.commit("auth/remove_notifications_inventory",t),this.hiddenNotifi=!1},showPermisoEspeciall:function(t){this.showPermisoEspecial=!0,this.$store.commit("auth/remove_notifications_inventory",t),this.hiddenNotifi=!1},saveDemandMaterial:function(){var t=this;this.responsable();var e=0;this.$refs.quantityInput.forEach((function(t){t.validate()&&e++}));for(var a=0,n=0;n<this.rows.length;n++){if(parseInt(this.$refs.quantityInput[n].value)+parseInt(this.rows[n].quantitySeleted)>this.rows[n].quantityTotal){this.$q.notify({message:"Material que desea registrar supera el que se establecio ",color:"red",position:"right"});break}a++}this.$refs.quantityInput.length===e&&this.rows.length===a?(console.log("Entro aquii bueno"),this.$q.loading.show(),this.$store.dispatch("order/savePurchaseOrder",[this.userResponsable,this.rows]).then((function(e){t.$q.loading.hide(),t.$q.notify({message:"Material Registrado con Exitos",color:"green",position:"right"}),t.showModalQuantity=!1,t.showNotaEntrega=!0})).catch((function(t){console.log(t)}))):console.log("Entro aquii malo")},responsable:function(){var t={id:1==this.showInterno?this.userSeleted.id:0,name:1==this.showInterno?this.userSeleted.name:this.name,last_name:1==this.showInterno?this.userSeleted.last_name:this.last_name,motivo:this.motivo,orderId:this.order.id,userResponsable:this.user.id};console.log("UserResponsable",t),this.userResponsable.push(t)},reset:function(){this.showNotaEntrega=!1,this.showInterno=!1,this.showExterno=!1,this.optionValue="",this.rows.forEach((function(t){t.cantSelected=0})),this.$root.$emit("inventory_refresh")},cargarSelectInternoExterno:function(){1==this.order.note_delivery_general[0].tipo&&(this.optionValue=this.order.note_delivery_general[0].tipo,this.nameInterno=this.order.note_delivery_general[0].request_user.name,this.last_nameInterno=this.order.note_delivery_general[0].request_user.last_name),2==this.order.note_delivery_general[0].tipo&&(this.optionValue=this.order.note_delivery_general[0].tipo,this.name=this.order.note_delivery_general[0].request_user.name,this.last_name=this.order.note_delivery_general[0].request_user.last_name),console.log(this.order)}},mounted:function(){this.$store.dispatch("users/getUsers"),console.log(this.order),this.cargarTable(),this.cargarSelectInternoExterno()}},Xt=Wt,Zt=a("3b73"),te=a("2c91"),ee=a("eb85"),ae=a("8f8e"),ne=Object(f["a"])(Xt,Yt,Gt,!1,null,null,null),oe=ne.exports;k()(ne,"components",{QExpansionItem:Zt["a"],QItemSection:j["a"],QItemLabel:kt["a"],QCardSection:b["a"],QBtn:g["a"],QSpace:te["a"],QDialog:T["a"],QCard:v["a"],QSeparator:ee["a"],QForm:_["a"],QSelect:y["a"],QItem:F["a"],QInput:w["a"],QCheckbox:ae["a"]}),k()(ne,"directives",{ClosePopup:x["a"]});var ie={data:function(){return{orders:[]}},components:{poCard:oe},methods:{cargarOrdenes:function(){var t=this;return l()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("order/getorder");case 2:return e.next=4,t.$store.getters["order/orders"];case 4:t.orders=e.sent,console.log("Orders",t.orders);case 6:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;this.cargarOrdenes(),this.$root.$on("refresh_order_innventory",(function(){t.cargarOrdenes()}))}},re=ie,se=Object(f["a"])(re,Vt,Ut,!1,null,null,null),le=se.exports;k()(se,"components",{QList:K["a"],QCardActions:q["a"],QBtn:g["a"]}),k()(se,"directives",{ClosePopup:x["a"]});var ce={data:function(){return{showReIngreso:!1,showDonacion:!1,showPrestamo:!1,showOC:!1,showTableMaterial:!1,options:[{id:1,name:"Donacion"},{id:2,name:"Prestamos"},{id:3,name:"Orden de Comprar"},{id:4,name:"Sobrante/Reingreso"}],optionValue:""}},components:{reEntry:Et,donacion:Rt,prestamo:Bt,po:le},computed:{},filters:{},watch:{optionValue:function(t,e){switch(console.log(t),t){case 1:this.showReIngreso=!1,this.showDonacion=!0,this.showPrestamo=!1,this.showOC=!1;break;case 2:this.showReIngreso=!1,this.showDonacion=!1,this.showPrestamo=!0,this.showOC=!1;break;case 3:this.showReIngreso=!1,this.showDonacion=!1,this.showPrestamo=!1,this.showOC=!0;break;case 4:this.showReIngreso=!0,this.showDonacion=!1,this.showPrestamo=!1,this.showOC=!1;break}}},methods:{},mounted:function(){}},ue=ce,de=a("d847"),me=a("05c0"),he=Object(f["a"])(ue,_t,wt,!1,null,null,null),pe=he.exports;k()(he,"components",{QBar:de["a"],QSpace:te["a"],QBtn:g["a"],QTooltip:me["a"],QCard:v["a"],QCardSection:b["a"],QSelect:y["a"]}),k()(he,"directives",{ClosePopup:x["a"]});var fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-bar",{staticClass:"bg-primary "},[a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[t._v("Close")])],1)],1),a("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"flex flex-center"},[a("div",{staticClass:"text-h6 text-black"},[t._v("Confirmaciones")])]),a("q-card-section",[t.orders.length>0?a("q-list",{staticClass:"text-black",attrs:{dark:"",bordered:"",separator:""}},t._l(t.orders,(function(e,n){return 1==e.special_permission&&2==e.confirmation?a("poCard",{key:n,attrs:{order:e}}):t._e()})),1):a("q-list",{staticClass:"text-black",attrs:{dark:"",bordered:"",separator:""}},[t._v("\n      Sin Ordenes que Confirmar\n  ")])],1)],1)],1)},ve=[],be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-expansion-item",{attrs:{"expand-separator":"","header-class":"item-vel bg-blue-grey-11 text-blue"},scopedSlots:t._u([{key:"header",fn:function(){return[a("q-item-section",[a("q-item-label",{staticClass:"text-black"},[t._v("Orden de Compra N # : "),a("strong",[t._v(" "+t._s(t.formatId(t.order.id)))])]),a("q-item-label",{staticClass:"text-black"},[t._v("Fecha :"),a("span",{},[a("strong",[t._v(" "+t._s(t._f("formatDate")(t.order.created_at))+" ")])])]),a("q-item-label",{staticClass:"text-black"},[t._v("Hora :"),a("span",{},[a("strong",[t._v(" "+t._s(t._f("formatTime")(t.order.created_at)))])])])],1)]},proxy:!0}])},[a("q-card",[a("div",[a("q-card-section",{staticClass:"q-mt-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 q-pa-sm"},[a("q-btn",{staticClass:"aboo_btn bg-green full-width",attrs:{label:"Confirmar Ingreso al Inventario"},on:{click:function(e){return t.ModalQuantity()}}})],1)])])],1)])],1),a("q-dialog",{staticClass:"flex flex-center ",attrs:{persistent:"",maximized:t.maximizedToggle},model:{value:t.showModalQuantity,callback:function(e){t.showModalQuantity=e},expression:"showModalQuantity"}},[a("q-card",{staticClass:"modal-card"},[a("q-card-section",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"text-subtitle2"},[t._v("Materiales")])]),a("q-separator"),a("div",[a("q-card-section",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[t.showInterno?a("div",[a("div",[a("q-select",{attrs:{clearable:"","bg-color":"white",outlined:"",options:t.userFilter,"option-value":function(t){return Object(t)===t&&"id"in t?t.id:null},"option-label":function(t){return Object(t)===t&&"name"in t?t.name+" "+t.last_name:""},"use-input":"",label:"Nombre y Apellido"},on:{filter:t.filter_user},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",{attrs:{clickable:""}},[a("q-item-section",{staticClass:"text-grey"},[t._v("\n                          no hay resultados\n                          ")])],1)]},proxy:!0}],null,!1,467460925),model:{value:t.userSeleted,callback:function(e){t.userSeleted=e},expression:"userSeleted"}})],1)]):t._e(),t.showExterno?a("div",[a("div",[a("q-input",{attrs:{type:"text",label:"Nombre",hint:"Nombre Obligatorio","label-color":"black"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("div",[a("q-input",{attrs:{type:"text",label:"Apellido",hint:"Apellido Obligatorio","label-color":"black"},model:{value:t.last_name,callback:function(e){t.last_name=e},expression:"last_name"}})],1),a("div",[a("q-input",{attrs:{type:"text",label:"Cedula",hint:"Cedula Obligatorio","label-color":"black"},model:{value:t.cedula,callback:function(e){t.cedula=e},expression:"cedula"}})],1)]):t._e(),a("div",[a("strong",[t._v("Responsable : "+t._s(t.order.request_user.name)+" "+t._s(t.order.request_user.last_name))])]),a("div",[a("iniciedFile",{attrs:{request:t.order}})],1)])],1),a("form",[t._l(t.rows,(function(e,n){return a("q-card-section",{key:n},[a("div",{staticClass:"text-h6 text-primary"},[a("q-input",{ref:"quantityInput",refInFor:!0,attrs:{label:e.material+" ( Cant :"+e.quantitySeleted+" ) ","stack-label":"",rules:[function(t){return!!t||"* Obligatorio"},function(t){return t<=e.quantity||"La cantidad debe ser menor o igual que "+e.quantity}],disable:!0},model:{value:e.quantitySeleted,callback:function(a){t.$set(e,"quantitySeleted",a)},expression:"material.quantitySeleted"}})],1)])})),t.showMotivo?a("q-card-section",[a("div",[a("q-input",{attrs:{filled:"",type:"textarea",label:"Motivo por las cantidades faltantes?"},model:{value:t.motivo,callback:function(e){t.motivo=e},expression:"motivo"}})],1)]):t._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 q-pa-sm"},[a("q-btn",{staticClass:"aboo_btn bg-green full-width",attrs:{label:"Confirmar"},on:{click:function(e){return t.notaEntrega()}}})],1),a("div",{staticClass:"col-6 q-pa-sm"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"aboo_btn  bg-red-4 full-width",attrs:{label:"Cancelar"}})],1)])],2)],1)],1)],1),a("q-dialog",{staticClass:"flex flex-center ",attrs:{persistent:"",maximized:t.maximizedToggle},model:{value:t.showNotaEntrega,callback:function(e){t.showNotaEntrega=e},expression:"showNotaEntrega"}},[a("q-card",{staticClass:"modal-card"},[a("q-card-section",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"text-subtitle2"},[t._v("Nota de Entrega")])]),a("q-separator"),a("div",[a("q-card-section",[a("q-form",{staticClass:"aboo_form q-gutter-sm"},[a("div",[a("strong",[t._v("Yo: "+t._s(t.order.request_user.name)+" "+t._s(t.order.request_user.last_name)+" recibi los siguientes materiales:")])]),a("div",[a("iniciedFile",{attrs:{request:t.order}})],1)])],1),a("form",[t._l(t.rows,(function(e,n){return a("q-card-section",{key:n},[a("div",{staticClass:"text-h6 text-primary"},[a("q-input",{ref:"quantityInput",refInFor:!0,attrs:{label:e.material+" ( Cant :"+e.quantitySeleted+" ) ","stack-label":"",disable:!0},model:{value:e.quantitySeleted,callback:function(a){t.$set(e,"quantitySeleted",a)},expression:"material.quantitySeleted"}})],1)])})),t.showMotivo?a("q-card-section",[a("div",[a("q-input",{attrs:{filled:"",type:"textarea",label:"Motivo por las cantidades faltantes?"},model:{value:t.motivo,callback:function(e){t.motivo=e},expression:"motivo"}})],1)]):t._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 q-pa-sm"},[a("q-btn",{staticClass:"aboo_btn  bg-red-4 full-width",attrs:{label:"Cancelar"},on:{click:function(e){return t.reset()}}})],1)])],2)],1)],1)],1)],1)},_e=[],we={data:function(){return{active:1,name:"",last_name:"",cedula:"",userSeleted:"",userFilter:[],options:[{id:1,name:"Interno"},{id:2,name:"Externo"}],optionValue:"",showInterno:!1,showExterno:!1,showMotivo:!1,showPermisoEspecial:!1,showNotaEntrega:!1,motivo:"",showModalQuantity:!1,maximizedToggle:!0,rows:[],columns:[],selected:[],allQuantity:"no",userResponsable:[]}},components:{tabs:V["a"],iniciedFile:Jt["a"]},props:["order"],computed:{user:{get:function(){return this.$store.getters["auth/user"]}},users:{get:function(){return this.$store.getters["users/users"]}}},filters:{formatDate:function(t){var e=t.split("T"),a=e[0].split("-"),n=new Date(a[0],a[1],a[2]);return gt["a"].formatDate(n,"DD-MM-YYYY")},formatTime:function(t){var e=t.split("T"),a=e[1].split(":"),n=new Date(a[0],a[1]);return gt["a"].formatDate(n,"hh:mm:ss A")}},watch:{allQuantity:function(t,e){"si"==t?(this.showMotivo=!1,this.rows.forEach((function(t){1==t.quantity?t.cantSelected=t.quantity:t.quantity==t.quantitySeleted?t.cantSelected=t.quantitySeleted:t.cantSelected=t.quantity}))):(this.showMotivo=!0,this.rows.forEach((function(t){t.cantSelected=0})))},optionValue:function(t,e){switch(console.log(t),this.name="",this.last_name="",this.userSeleted="",t){case 1:this.showInterno=!0,this.showExterno=!1;break;case 2:this.showInterno=!1,this.showExterno=!0;break}},userSeleted:function(t,e){console.log("User Selected",t),console.log("User Activo",this.user)}},methods:{filter_user:function(t,e,a){var n=this;t.length<2?a():e((function(){var e=t.toLowerCase();n.userFilter=n.users.filter((function(t){return t.name.toLowerCase().indexOf(e)>-1}))}))},formatId:function(t){for(var e=String(t),a="#",n=4-e.length,o=0;o<n;o++)a+="0";return a+e},cargarTable:function(){var t=this;this.columns=[],this.rows=[];var e=this;this.order.applicants.forEach((function(a){var n={material:a.material.name,quantityTotal:a.material.quantity,quantity:a.material.quantity-a.material.quantity_selected_po,quantitySeleted:a.material.quantity_selected_po,price:a.price,id:a.id,orderId:t.order.id,materialId:a.material_id,inventoryId:null==a.material.inventory_id?0:a.material.inventory_id,cantSelected:0,measureId:a.material.measure_id,quantityEntregada:a.material.quantity_selected};e.rows.push(n)}))},ModalQuantity:function(){this.showModalQuantity=!0},reset:function(){this.showNotaEntrega=!1,this.showInterno=!1,this.showExterno=!1,this.optionValue="",this.$root.$emit("refresh_order_confirmacion")},notaEntrega:function(){var t=this;this.$q.loading.show(),this.$store.dispatch("order/confirmation",this.rows).then((function(e){t.$q.notify({message:"Material Confirmado Exitosamente",color:"green",position:"right"}),t.showNotaEntrega=!0,t.$q.loading.hide()})).catch((function(t){console.log(t)}))}},mounted:function(){this.$store.dispatch("users/getUsers"),console.log(this.order),this.cargarTable()}},ye=we,qe=Object(f["a"])(ye,be,_e,!1,null,null,null),ge=qe.exports;k()(qe,"components",{QExpansionItem:Zt["a"],QItemSection:j["a"],QItemLabel:kt["a"],QCard:v["a"],QCardSection:b["a"],QBtn:g["a"],QDialog:T["a"],QSeparator:ee["a"],QForm:_["a"],QSelect:y["a"],QItem:F["a"],QInput:w["a"]}),k()(qe,"directives",{ClosePopup:x["a"]});var xe={data:function(){return{orders:[]}},components:{poCard:ge},computed:{user:{get:function(){var t=this.$store.getters["auth/user"];return t}}},watch:{},methods:{cargarOrdenes:function(){var t=this;return l()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("order/getorder");case 2:return e.next=4,t.$store.getters["order/orders"];case 4:t.orders=e.sent,console.log("Orders",t.orders);case 6:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;this.cargarOrdenes(),this.$root.$on("refresh_order_confirmacion",(function(){t.cargarOrdenes()}))}},Ce=xe,ke=Object(f["a"])(Ce,fe,ve,!1,null,null,null),$e=ke.exports;k()(ke,"components",{QBar:de["a"],QSpace:te["a"],QBtn:g["a"],QTooltip:me["a"],QCard:v["a"],QCardSection:b["a"],QList:K["a"]}),k()(ke,"directives",{ClosePopup:x["a"]});var Ie={data:function(){return{showModal:!1,showModalDead:!1,showModalReturn:!1,showDemandReturn:!1,showConfirmacion:!1,showAlert:!1,showReEntry:!1,maximizedToggle:!0,materials:[],rows:[],columns:[],numbControl:"",active:1,dead:!1,showSearch:!1,filter:[],inventories:[]}},components:{tables:U["a"],header_vel:c["a"],inventoryForm:I,inventoryCard:B,tabs:V["a"],inventoryFormDead:X,inventoryDemandReturn:it,inventoryDemandCardReturn:dt,inputSearch:bt,reEntry:pe,confirmation:$e,notificationsCounterForIten:Kt["a"]},computed:{},watch:{active:function(t,e){switch(t){case 1:this.columRowDead();break;case 2:this.columRow();break}}},methods:{cargarInventory:function(){var t=this;return l()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("inventory/getInventory");case 2:return e.next=4,t.$store.getters["inventory/inventory"];case 4:t.inventories=e.sent,console.log("Inventario",t.inventories);case 6:case"end":return e.stop()}}),e)})))()},quantityColor:function(t){var e="";return 0==t?e="red":t>=1&&t<=3?e="yellow":t>=4&&(e="positive"),e},alert:function(t){return 1==t?"notifications":"notifications_active"},colorAlert:function(t){return 1==t?"positive":"red"},mostrar:function(){this.showAlert=!0},columRow:function(){this.columns=[],this.rows=[],this.columns=[{name:"code",label:"Codigo",align:"center",field:"code",sortable:!0},{name:"material",label:"Materiales",align:"center",field:"material",sortable:!0},{name:"quantity",label:"Disponible",align:"center",field:"quantity",sortable:!0},{name:"stock",label:"Reserva",align:"center",field:"stock",sortable:!0},{name:"um",label:"UM",align:"center",field:"um",sortable:!0}];var t=this;this.inventories.forEach((function(e){var a={code:"VS-00"+e.id,material:e.name,quantity:e.quantity,stock:e.block_stock,um:e.measure.measure};t.rows.push(a)}))},columRowDead:function(){console.log("Inventario Muerto"),this.columns=[],this.rows=[],this.columns=[{name:"material",label:"Materiales",align:"center",field:"material",sortable:!0},{name:"quantity",label:"Cantidad",align:"center",field:"quantity",sortable:!0},{name:"dead",label:"Dead",align:"center",field:"dead",sortable:!0},{name:"um",label:"UM",align:"center",field:"um",sortable:!0}];var t=this;this.inventories.forEach((function(e){if(e.dead>0){var a={material:e.name,quantity:e.quantity,dead:e.dead,um:e.measure.measure};t.rows.push(a)}}))},columRowDemand:function(t){this.columns=[{name:"material",label:"Materiales",align:"center",field:"material",sortable:!0},{name:"um",label:"UM",align:"center",field:"um",sortable:!0},{name:"quantity",label:"Cantidad",align:"center",field:"quantity",sortable:!0},{name:"step",label:"Estatu",align:"center",field:"step",sortable:!0}];var e=this;this.search.materials.forEach((function(t){var a={material:t.name,um:t.measure.measure,quantity:t.quantity,step:t.status_id};e.rows.push(a)}))}},beforeMount:function(){},mounted:function(){var t=this;this.cargarInventory(),setTimeout((function(){t.columRow()}),500),this.$root.$on("inventory_refresh",(function(){console.log("Entro aqui"),t.showModal=!1,t.showModalDead=!1,t.showReEntry=!1,t.cargarInventory(),1==t.active?(console.log("Muerto"),t.columRowDead()):2==t.active&&(console.log("Inventario"),setTimeout((function(){t.columRow()}),500))})),this.$root.$on("searchDemand",(function(e){t.showModalReturn=!1,t.showDemandReturn=!0,t.columRowDemand(e),t.materials=e.materials,t.numbControl=e.control_number})),this.$root.$on("searchFilter",(function(e){t.showSearch=!0,t.filter=e}))}},Ne=Ie,Se=Object(f["a"])(Ne,i,r,!1,null,null,null),Qe=Se.exports;k()(Se,"components",{QBtn:g["a"],QIcon:nt["a"],QDialog:T["a"],QTable:$t["a"],QTd:It["a"],QBadge:Nt["a"],QList:K["a"],QInput:w["a"],QSeparator:ee["a"],QPopupEdit:St["a"]});var Ee={name:"PageInventory",data:function(){return{}},components:{inventario:Qe},methods:{inicialize:function(){}},mounted:function(){this.inicialize()}},Me=Ee,De=a("9989"),Oe=Object(f["a"])(Me,n,o,!1,null,null,null);e["default"]=Oe.exports;k()(Oe,"components",{QPage:De["a"]})}}]);