(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[40],{"3ee1":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",[s("users")],1)},o=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("header_vel",[e._v("\r\n        Usuarios\r\n    ")]),e.$permissions("usuarios.agregar")?s("q-btn",{attrs:{label:"crear",icon:"add"},on:{click:function(t){e.showModal=!e.showModal}}}):e._e(),s("q-dialog",{model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[s("usersForm")],1),s("q-list",{attrs:{dark:"",bordered:"",separator:""}},e._l(e.users,(function(e,t){return s("usersCard",{key:t,attrs:{user:e}})})),1)],1)},i=[],r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[s("q-card-section",{staticClass:"flex flex-center"},[s("div",{staticClass:"text-h6 text-black"},[e._v("Nuevo")])]),s("q-card-section",[s("q-form",{staticClass:"aboo_form q-gutter-sm"},[s("div",[s("q-input",{attrs:{outlined:"",type:"text",label:"Nombre","label-color":"black"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),s("div",[s("q-input",{attrs:{outlined:"",type:"text",label:"Apellido","label-color":"black"},model:{value:e.user.last_name,callback:function(t){e.$set(e.user,"last_name",t)},expression:"user.last_name"}})],1),s("div",[s("q-input",{attrs:{outlined:"",type:"email",label:"Correo","label-color":"black"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),s("div"),s("div",[s("q-input",{attrs:{outlined:"",type:"password",label:"Contraseña","label-color":"black"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),s("div",[s("q-input",{attrs:{outlined:"",type:"password",label:"verificar Contraseña","label-color":"black"},model:{value:e.password_verify,callback:function(t){e.password_verify=t},expression:"password_verify"}})],1),s("div"),s("div"),s("div",[s("q-select",{attrs:{outlined:"","options-dark":"","label-color":"black",options:e.clients,"option-value":function(e){return Object(e)===e&&"id"in e?e.id:null},"option-label":function(e){return Object(e)===e&&"name"in e?e.name:"- Null -"},label:"Clientes","emit-value":"","map-options":""},model:{value:e.user.client_id,callback:function(t){e.$set(e.user,"client_id",t)},expression:"user.client_id"}})],1),s("div",[s("q-select",{attrs:{outlined:"","options-dark":"","label-color":"black",options:e.departments,"option-value":function(e){return Object(e)===e&&"id"in e?e.id:null},"option-label":function(e){return Object(e)===e&&"name"in e?e.name:"- Null -"},label:"Departamento","emit-value":"","map-options":""},model:{value:e.user.departament,callback:function(t){e.$set(e.user,"departament",t)},expression:"user.departament"}})],1),s("div",[s("q-select",{attrs:{outlined:"","use-chips":"","options-dark":"",multiple:"","label-color":"black",options:e.roles,"option-value":function(e){return Object(e)===e&&"name"in e?e.name:null},"option-label":function(e){return Object(e)===e&&"name"in e?e.name:"- Null -"},label:"Roles","emit-value":"","map-options":""},model:{value:e.user.role,callback:function(t){e.$set(e.user,"role",t)},expression:"user.role"}})],1)])],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{attrs:{flat:"",label:e.user._id?"Actualizar":"guardar",color:"green",loading:e.loading},on:{click:e.validate}}),s("q-btn",{attrs:{flat:"",label:"cerrar",color:"primary"},on:{click:e.cerrar}})],1)],1)],1)},l=[],u=(s("b0c0"),s("bc3a")),c=s.n(u),d=s("ae33"),m={data:function(){return{show:!1,password:null,password_verify:null,loading:!1,roles:[],clients:[]}},props:{user:{type:Object,default:function(){return{_id:null,name:null,last_name:null,email:null,password:null,avatar:"descarga.png",departament:null,ods:!1,role:[],client_id:null}}}},computed:{departments:{get:function(){return this.$store.getters["departments/departments"]}}},methods:{getroles:function(){var e=this;this.$q.loading.show(),c.a.get("/roles").then((function(t){e.$q.loading.hide(),console.log(t),e.roles=t.data})).catch((function(t){console.log(t),e.$q.loading.hide()}))},getClients:function(){var e=this;this.$q.loading.show(),c.a.get("/client/index").then((function(t){e.$q.loading.hide(),console.log(t),e.clients=t.data})).catch((function(t){console.log(t),e.$q.loading.hide()}))},initialize:function(){this.user._id=this.user.id?this.user.id:null,this.user.departament=this.user.id?this.user.department_id:null},store:function(){this.loading=!0,this.user._id?this.update():this.create()},create:function(){var e=this,t=new FormData;t.append("email",this.user.email),t.append("name",this.user.name),t.append("last_name",this.user.last_name),t.append("password",this.user.password),t.append("department_id",this.user.departament),t.append("role",this.user.role),t.append("client_id",this.user.client_id),this.$store.dispatch("users/store",t).then((function(t){e.$q.notify({message:"Guardado con exitos",color:"green",position:"right"}),e.$root.$emit("users_refresh")})).catch((function(e){console.log(e)}))},update:function(){var e=this;this.$store.dispatch("users/update",this.user).then((function(t){e.$q.notify({message:"actualizado con exitos",color:"green",position:"right"}),e.$root.$emit("updateDone")})).catch((function(e){console.log(e)}))},cerrar:function(){this.$root.$emit("users_refresh"),this.$root.$emit("updateDone")},NotNull:d["a"],validate:function(){this.NotNull([{val:this.user.name,message:"Debe colocar nombre"},{val:this.user.last_name,message:"Debe colocar apellido"},{val:this.user.email,message:"Debe colocar email"},{val:this.user.departament,message:"Debe seleccionar Departamento"}],this.store)}},mounted:function(){this.getClients(),this.initialize(),this.getroles()}},p=m,h=s("2877"),f=s("f09f"),b=s("a370"),v=s("0378"),g=s("27f9"),_=s("8f8e"),$=s("ddd8"),w=s("4b7e"),q=s("9c40"),k=s("eebe"),x=s.n(k),C=Object(h["a"])(p,r,l,!1,null,null,null),Q=C.exports;x()(C,"components",{QCard:f["a"],QCardSection:b["a"],QForm:v["a"],QInput:g["a"],QCheckbox:_["a"],QSelect:$["a"],QCardActions:w["a"],QBtn:q["a"]});var D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"  item-vel full-width",attrs:{clickable:""}},[s("q-item-section",[e._v(e._s(e.user.name)+" "+e._s(e.user.last_name))]),e.$permissions("usuarios.editar")?s("q-btn",{attrs:{flat:"",dense:"",icon:"edit"},on:{click:function(t){e.showForm=!e.showForm}}}):e._e(),e.$permissions("usuarios.eliminar")?s("q-btn",{attrs:{flat:"",dense:"",icon:"delete"},on:{click:function(t){e.showDelete=!e.showDelete}}}):e._e()],1),s("q-dialog",{model:{value:e.showForm,callback:function(t){e.showForm=t},expression:"showForm"}},[s("usersForm",{attrs:{user:e.user}})],1),s("q-dialog",{model:{value:e.showDelete,callback:function(t){e.showDelete=t},expression:"showDelete"}},[s("deleteModal",{attrs:{_id:e.user.id}})],1)],1)},y=[],F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("q-card",{staticClass:"my-card"},[s("q-card-section",{staticClass:"bg-red-5 text-white text-center"},[s("div",{staticClass:"text-h6"},[e._v("¿Seguro quiere eliminar este usuario?")])]),s("q-separator"),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{staticClass:"text-blue",attrs:{flat:""},on:{click:function(t){return e.remove()}}},[e._v("Eliminar")]),s("q-btn",{staticClass:"text-red",attrs:{flat:""},on:{click:function(t){return e.$root.$emit("close_delete")}}},[e._v("Cancelar")])],1)],1)],1)},O=[],j={data:function(){return{}},props:{_id:String},methods:{remove:function(){var e=this;this.$q.loading.show(),axios.delete("/user/"+this._id).then((function(t){e.$q.notify({message:"eliminado con exitos con exitos",color:"green",position:"right"}),e.$q.loading.hide(),e.$root.$emit("users_refresh"),e.$root.$emit("close_delete")})).catch((function(t){console.log(t),e.$q.loading.hide()}))}}},N=j,M=s("eb85"),S=Object(h["a"])(N,F,O,!1,null,null,null),E=S.exports;x()(S,"components",{QCard:f["a"],QCardSection:b["a"],QSeparator:M["a"],QCardActions:w["a"],QBtn:q["a"]});var z={data:function(){return{showForm:!1,showDelete:!1}},props:["user"],components:{usersForm:Q,deleteModal:E},methods:{cerrar:function(){this.$root.$emit("users_refresh")}},mounted:function(){var e=this;this.$root.$on("close_delete",(function(){e.showDelete=!1})),this.$root.$on("updateDone",(function(){e.showForm=!1,e.$root.$emit("users_refresh")}))}},P=z,A=s("66e5"),B=s("4074"),I=s("24e8"),U=s("714f"),J=Object(h["a"])(P,D,y,!1,null,null,null),R=J.exports;x()(J,"components",{QItem:A["a"],QItemSection:B["a"],QBtn:q["a"],QDialog:I["a"]}),x()(J,"directives",{Ripple:U["a"]});var V=s("d784d"),G=(s("159b"),{"usuarios.listar":!1,"usuarios.editar":!1,"usuarios.agregar":!1,"usuarios.eliminar":!1}),L=function(e,t){console.log(t),e.forEach((function(e){t.hasOwnProperty(e.name)&&(t[e.name]=!0)})),console.log(t)},H={data:function(){return{showModal:!1,permissions:G}},components:{usersForm:Q,usersCard:R,header_vel:V["a"]},computed:{users:{get:function(){return this.$store.getters["users/users"]}},user:{get:function(){return this.$store.getters["auth/user"]}}},methods:{ValidationPermissions:L},mounted:function(){var e=this;this.ValidationPermissions(this.user.roles[0].permissions,this.permissions),this.$root.$on("users_refresh",(function(){e.showModal=!1,e.showForm=!1}))}},K=H,T=s("1c1c"),W=Object(h["a"])(K,n,i,!1,null,null,null),X=W.exports;x()(W,"components",{QBtn:q["a"],QDialog:I["a"],QList:T["a"]});var Y={name:"PageUsers",data:function(){return{}},components:{users:X},methods:{inicialize:function(){this.$store.dispatch("users/getUsers"),this.$store.dispatch("departments/getDepartments")}},mounted:function(){this.inicialize()}},Z=Y,ee=s("9989"),te=Object(h["a"])(Z,a,o,!1,null,null,null);t["default"]=te.exports;x()(te,"components",{QPage:ee["a"]})}}]);