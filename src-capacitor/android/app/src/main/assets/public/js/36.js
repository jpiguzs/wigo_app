(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[36],{"1fb8":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",[o("request")],1)},n=[],i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("header_vel",[e._v("\n   solicitudes\n")]),o("q-btn",{attrs:{label:"crear",icon:"add"},on:{click:function(t){e.showModal=!e.showModal}}}),o("q-dialog",{staticClass:"flex flex-center",model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[o("requestForm")],1),e.request.length>0?o("q-list",{attrs:{dark:"",bordered:"",separator:""}},e._l(e.request,(function(e,t){return o("requestCard",{key:t,attrs:{request:e}})})),1):e._e()],1)},r=[],a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("q-card",{staticClass:"full-width",staticStyle:{"min-width":"300px"}},[o("q-card-section",{staticClass:"flex flex-center"},[o("div",{staticClass:"text-h6 text-black"},[e._v("Nuevo")])]),o("q-card-section",[e.showAddProduct?e._e():o("q-form",{staticClass:"aboo_form q-gutter-sm "},[o("div",[o("q-input",{attrs:{outlined:"",type:"textarea",label:"descripcion","label-color":"black"},model:{value:e.request.description,callback:function(t){e.$set(e.request,"description",t)},expression:"request.description"}})],1),o("div",[o("q-input",{attrs:{outlined:"",type:"text",label:"lugar","label-color":"black"},model:{value:e.request.place,callback:function(t){e.$set(e.request,"place",t)},expression:"request.place"}})],1),o("div"),o("div"),o("div",[o("q-input",{attrs:{outlined:"",type:"date",label:"fecha de proyecto","label-color":"black"},model:{value:e.request.poryectDate,callback:function(t){e.$set(e.request,"poryectDate",t)},expression:"request.poryectDate"}})],1),o("div",[o("q-select",{attrs:{outlined:"","options-dark":"","label-color":"black",options:e.discipline,"option-value":function(e){return Object(e)===e&&"name"in e?e.name:null},"option-label":function(e){return Object(e)===e&&"name"in e?e.name:"- Null -"},label:"disciplina","emit-value":"","map-options":""},model:{value:e.request.discipline,callback:function(t){e.$set(e.request,"discipline",t)},expression:"request.discipline"}})],1),o("div",{staticClass:"text-black"},[e._v("\n            Materiales "),o("q-btn",{staticClass:"bg-blue",attrs:{rounded:"",icon:"add"},on:{click:function(t){e.showAddProduct=!e.showAddProduct}}}),o("div",[e.request.products.length>0?o("q-list",{staticStyle:{"max-width":"318px"},attrs:{bordered:"",separator:""}},e._l(e.request.products,(function(t,s){return o("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:s,attrs:{clickable:""}},[o("q-item-section",[e._v(" "+e._s(t.name?t.name:t[0].name)+", "+e._s(t.quantity?t.quantity:t[0].quantity))]),o("q-item-section",[o("q-btn",{attrs:{flat:"",icon:"delete"}})],1)],1)})),1):e._e()],1)],1),o("div")]),e.showAddProduct?o("div",[o("q-input",{attrs:{outlined:"",type:"text",label:"Descripcion"},model:{value:e.productName,callback:function(t){e.productName=t},expression:"productName"}}),o("q-input",{attrs:{outlined:"",type:"text",label:"Unidades"},model:{value:e.productNr,callback:function(t){e.productNr=t},expression:"productNr"}}),o("q-btn",{staticClass:"primary full-width",attrs:{label:"agregar",color:"primary"},on:{click:e.addProduct}}),o("q-btn",{staticClass:"btn-danger full-width",attrs:{label:"Cancelar",color:"red"},on:{click:function(t){e.showAddProduct=!e.showAddProduct}}})],1):e._e()],1),o("q-card-actions",{attrs:{align:"right"}},[o("q-btn",{attrs:{flat:"",label:e.request._id?"Actualizar":"guardar",color:"green",loading:e.loading},on:{click:function(t){return e.store()}}}),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cerrar",color:"primary"}})],1)],1)],1)},l=[],c=(o("a4d3"),o("e01a"),{data:function(){return{show:!1,password:null,password_verify:null,discipline:[],loading:!1,showAddProduct:!1,productName:null,productNr:null}},props:{request:{type:Object,default:function(){return{_id:null,description:null,controlNumber:null,ods:null,status:null,place:null,products:[],poryectDate:null,discipline:null,departamentUser:null,user:null}}}},computed:{user:{get:function(){return this.$store.getters["auth/user"]}}},methods:{getdiscipline:function(){var e=this;this.$q.loading.show(),axios.get("/discipline").then((function(t){e.$q.loading.hide(),console.log(t),e.discipline=t.data})).catch((function(t){console.log(t),e.$q.loading.hide()}))},store:function(){this.request.description?(this.loading=!0,this.request.departamentUser=this.user.departament,this.request.user=this.user._id,this.request._id?this.update():this.create()):this.$q.notify({message:"debe colocar un nombre",color:"red",position:"right"})},create:function(){var e=this;axios.post("/request",this.request).then((function(t){e.$q.notify({message:"Guardado con exitos",color:"green",position:"right"}),e.$root.$emit("request_refresh")})).catch((function(e){console.log(e)}))},update:function(){var e=this;axios.put("/request/"+this.request._id,this.request).then((function(t){e.$q.notify({message:"actualizado con exitos",color:"green",position:"right"}),e.$root.$emit("request_refresh")})).catch((function(e){console.log(e)}))},addProduct:function(){if(!this.productName)return this.$q.notify({message:"coloque una descripcion",color:"red",position:"right"});var e={name:this.productName,quantity:this.productNr,complete:!1};this.request.products.push(e),this.showAddProduct=!1,this.productName=null,this.productNr=null}},mounted:function(){this.getdiscipline()}}),u=c,d=o("2877"),p=o("f09f"),q=o("a370"),h=o("0378"),f=o("27f9"),m=o("ddd8"),g=o("9c40"),b=o("1c1c"),v=o("66e5"),_=o("4074"),w=o("4b7e"),$=o("714f"),x=o("7f67"),C=o("eebe"),k=o.n(C),y=Object(d["a"])(u,a,l,!1,null,null,null),Q=y.exports;k()(y,"components",{QCard:p["a"],QCardSection:q["a"],QForm:h["a"],QInput:f["a"],QSelect:m["a"],QBtn:g["a"],QList:b["a"],QItem:v["a"],QItemSection:_["a"],QCardActions:w["a"]}),k()(y,"directives",{Ripple:$["a"],ClosePopup:x["a"]});var N=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"  item-vel full-width",attrs:{clickable:""}},[o("q-item-section",[e._v(e._s(e.request.description))]),o("q-item-section",[e._v(e._s(e.statusString(e.request.status)))]),o("q-btn",{attrs:{flat:"",dense:"",icon:"edit"},on:{click:function(t){e.showForm=!e.showForm}}}),o("q-btn",{attrs:{flat:"",dense:"",icon:"delete"},on:{click:function(t){e.showDelete=!e.showDelete}}}),o("q-btn",{attrs:{flat:"",dense:"",icon:"visibility"},on:{click:function(t){e.showView=!e.showView}}})],1),o("q-dialog",{attrs:{persistent:""},model:{value:e.showForm,callback:function(t){e.showForm=t},expression:"showForm"}},[o("requestForm",{attrs:{request:e.request}})],1),o("q-dialog",{model:{value:e.showDelete,callback:function(t){e.showDelete=t},expression:"showDelete"}},[o("deleteModal",{attrs:{_id:e.request._id}})],1),o("q-dialog",{model:{value:e.showView,callback:function(t){e.showView=t},expression:"showView"}},[o("requestView",{attrs:{request:e.request}})],1)],1)},P=[],D=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("q-card",{staticClass:"my-card"},[o("q-card-section",{staticClass:"bg-red-5 text-white text-center"},[o("div",{staticClass:"text-h6"},[e._v("Â¿Seguro quiere eliminar este Modulo?")])]),o("q-separator"),o("q-card-actions",{attrs:{align:"right"}},[o("q-btn",{staticClass:"text-blue",attrs:{flat:""},on:{click:function(t){return e.remove()}}},[e._v("Eliminar")]),o("q-btn",{staticClass:"text-red",attrs:{flat:""},on:{click:function(t){return e.$root.$emit("close_delete")}}},[e._v("Cancelar")])],1)],1)],1)},S=[],j={data:function(){return{}},props:{_id:String},methods:{remove:function(){var e=this;this.$q.loading.show(),axios.delete("/request/"+this._id).then((function(t){e.$q.notify({message:"eliminado con exitos con exitos",color:"green",position:"right"}),e.$q.loading.hide(),e.$root.$emit("request_refresh"),e.$root.$emit("close_delete")})).catch((function(t){console.log(t),e.$q.loading.hide()}))}}},A=j,F=o("eb85"),M=Object(d["a"])(A,D,S,!1,null,null,null),O=M.exports;k()(M,"components",{QCard:p["a"],QCardSection:q["a"],QSeparator:F["a"],QCardActions:w["a"],QBtn:g["a"]});var V=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("q-card",{ref:e.request._id,staticClass:"bg-white"},[o("q-card-section",{staticClass:"flex flex-center bg-blue"},[e._v("\n        \n                Numero de control: "+e._s(e.request.controlNumber)+"\n        ")]),o("q-card-section",{staticClass:"text-blue"},[e._v("\n              Ods: "+e._s(e.request.ods)+"\n        ")]),o("q-card-section",{staticClass:"text-blue"},[e._v("\n              Disciplina: "+e._s(e.request.discipline)+"\n        ")]),o("q-card-section",{staticClass:"text-blue"},[e._v("\n              Lugar: "+e._s(e.request.place)+"\n        ")]),o("q-card-section",{staticClass:"text-blue"},[e._v("\n              Descripcion: "+e._s(e.request.description)+"\n        ")]),o("q-card-section",{staticClass:"text-blue"},[e._v("\n              Fecha: "+e._s(e.request.poryectDate)+"\n        ")]),o("q-card-section",{staticClass:"text-blue"},[e._v("\n              status: "+e._s(e.statusString(e.request.status))+"\n        ")]),o("q-card-section",{staticClass:"text-blue"},e._l(e.request.products[0],(function(t,s){return e.request.products.length>0?o("div",{key:s},[o("div",[e._v(" producto: "+e._s(t.name)+" ")]),o("div",[e._v(" unidades: "+e._s(t.quantity)+" ")])]):e._e()})),0),o("q-card-actions",[1===e.request.status||null===e.request.status?o("q-btn",{staticClass:"bg-primary",attrs:{label:"aporbar"},on:{click:function(t){return e.aprove()}}}):e._e(),2===e.request.status?o("q-btn",{staticClass:"bg-green",attrs:{label:"Crear requicion de estos productos"},on:{click:function(t){return e.requireProdects()}}}):e._e()],1)],1)],1)},E=[],I=o("8baf"),B=o("c0e9"),z=o.n(B),L=o("bc3a"),U=o.n(L),R={data:function(){return{}},props:["request"],methods:{statusString:function(e){return 1===e||null===e?"Pendiente Por aprobacion":2===e?"Aprobado":3===e?"Aprobado con requesicion creada":4===e?"trabajo en ejecucion":5===e?"trabajo culmindao":void 0},aprove:function(){var e=this;this.$q.loading.show(),U.a.patch("/request/"+this.request._id,{status:2}).then((function(t){console.log(t),e.$q.loading.hide(),e.$q.notify({message:"aprovado con exitos",color:"green",position:"right"}),e.$root.$emit("request_refresh")})).catch((function(t){console.log(t),e.$q.loading.hide()}))},requireProdects:function(){var e=this;this.$q.loading.show(),U.a.post("/require",this.request).then((function(t){console.log(t),U.a.patch("/request/"+e.request._id,{status:3}).then((function(t){console.log(t),e.$q.loading.hide(),e.$q.notify({message:"requiscion creada  con exitos",color:"green",position:"right"}),e.$root.$emit("request_refresh")})).catch((function(t){console.log(t),e.$q.loading.hide()}))})).catch((function(t){console.log(t),e.$q.loading.hide()}))},download:function(){},downloadWithCSS:function(){var e=new I["a"],t=(this.$refs[this.request._id].$el.offsetWidth,this.$refs[this.request._id].$el.offsetHeight,document.createElement("canvas"));console.log(this.$refs[this.request._id].$el),z()(this.$refs[this.request._id].$el,{canvas:t,scale:1}).then((function(o){console.log(t);var s=o.toDataURL("image/jpeg");console.log(s),e.addImage(s,"PNG",10,10),e.save("sample.pdf")}))}}},G=R,J=Object(d["a"])(G,V,E,!1,null,null,null),T=J.exports;k()(J,"components",{QCard:p["a"],QCardSection:q["a"],QCardActions:w["a"],QBtn:g["a"]});var W={data:function(){return{showForm:!1,showDelete:!1,maximizedToggle:!0,showView:!1}},components:{requestForm:Q,deleteModal:O,requestView:T},props:["request"],mounted:function(){var e=this;this.$root.$on("close_delete",(function(){e.showDelete=!1})),this.$root.$on("request_refresh",(function(){e.showView=!1}))},methods:{statusString:function(e){return 1===e||null===e?"Pendiente Por aprobacion":2===e?"Aprobado":3===e?"Aprobado con requesicion creada":4===e?"trabajo en ejecucion":5===e?"trabajo culmindao":void 0}}},H=W,K=o("24e8"),X=Object(d["a"])(H,N,P,!1,null,null,null),Y=X.exports;k()(X,"components",{QItem:v["a"],QItemSection:_["a"],QBtn:g["a"],QDialog:K["a"]}),k()(X,"directives",{Ripple:$["a"]});var Z=o("d784d"),ee={data:function(){return{showModal:!1,maximizedToggle:!0,request:[]}},components:{requestForm:Q,requestCard:Y,header_vel:Z["a"]},methods:{getrequest:function(){var e=this;this.$q.loading.show(),axios.get("/request").then((function(t){e.$q.loading.hide(),console.log(t),e.request=t.data})).catch((function(t){console.log(t),e.$q.loading.hide()}))}},mounted:function(){var e=this;this.getrequest(),this.$root.$on("request_refresh",(function(){e.getrequest(),e.showModal=!1}))}},te=ee,oe=Object(d["a"])(te,i,r,!1,null,null,null),se=oe.exports;k()(oe,"components",{QBtn:g["a"],QDialog:K["a"],QList:b["a"]});var ne={components:{request:se}},ie=ne,re=o("9989"),ae=Object(d["a"])(ie,s,n,!1,null,null,null);t["default"]=ae.exports;k()(ae,"components",{QPage:re["a"]})}}]);